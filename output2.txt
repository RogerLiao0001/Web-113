 py % python pyqclaude3.py
RSA量子固定點攻擊 - 修正版
當前日期時間: 2025-04-14 22:11:11
當前用戶: RogerLiao0001

==================================================
開始RSA量子固定點攻擊測試 - 修正版
當前日期時間: 2025-04-14 22:11:11
當前用戶: RogerLiao0001
==================================================


==================== 測試案例 1: 微型RSA(p=3,q=5) ====================
加密: 4^3 mod 15 = 4

==================== RSA量子固定點攻擊 ====================
模數 n = 15
指數 e = 3
密文 C = 4
根據n的大小(4位)設置量子相位估計參數: 精度=10位, 測量=2000次

--- 步驟 1: 計算模冪運算基底 ---
  B = C^(n*e) mod n = 4^(45) mod 15 = 4
  使用改進的量子相位估計模擬 (精度=10位, 2000次測量)
  找到乘法階 r = 2

--- 步驟 2: 分析量子相位估計結果 ---
相位測量結果：
  相位：0.500000, 概率：1.0000

從相位中提取可能的r值：
  分析相位 0.500000 (權重:1.0000):
    連分數近似: 1/2, 誤差: 0.000000
    添加r = 2 到候選列表 (評分:1.0000)
  添加理論值 r = 4 到候選列表 (評分:0.5000)
  添加理論值 r = 8 到候選列表 (評分:0.5000)

排序後的r值候選列表：
  候選 1: r = 2, 評分 = 1.0000
  候選 2: r = 4, 評分 = 0.5000
  候選 3: r = 8, 評分 = 0.5000

--- 步驟 3: 使用r = 2恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 4恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 8恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

==================== 攻擊結果 ====================
攻擊失敗，無法恢復明文
用時: 0.00 秒

==================== 測試案例 2: 小型RSA(p=5,q=7) ====================
加密: 6^5 mod 35 = 6

==================== RSA量子固定點攻擊 ====================
模數 n = 35
指數 e = 5
密文 C = 6
根據n的大小(6位)設置量子相位估計參數: 精度=10位, 測量=2000次

--- 步驟 1: 計算模冪運算基底 ---
  B = C^(n*e) mod n = 6^(175) mod 35 = 6
  使用改進的量子相位估計模擬 (精度=10位, 2000次測量)
  找到乘法階 r = 2

--- 步驟 2: 分析量子相位估計結果 ---
相位測量結果：
  相位：0.500000, 概率：1.0000

從相位中提取可能的r值：
  分析相位 0.500000 (權重:1.0000):
    連分數近似: 1/2, 誤差: 0.000000
    添加r = 2 到候選列表 (評分:1.0000)
  添加理論值 r = 12 到候選列表 (評分:0.5000)
  添加理論值 r = 24 到候選列表 (評分:0.5000)
  添加理論值 r = 6 到候選列表 (評分:0.5000)

排序後的r值候選列表：
  候選 1: r = 2, 評分 = 1.0000
  候選 2: r = 12, 評分 = 0.5000
  候選 3: r = 24, 評分 = 0.5000
  候選 4: r = 6, 評分 = 0.5000

--- 步驟 3: 使用r = 2恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 12恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 24恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 6恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

==================== 攻擊結果 ====================
攻擊失敗，無法恢復明文
用時: 0.00 秒

==================== 測試案例 3: 較小RSA(p=7,q=11) ====================
加密: 42^7 mod 77 = 70

==================== RSA量子固定點攻擊 ====================
模數 n = 77
指數 e = 7
密文 C = 70
根據n的大小(7位)設置量子相位估計參數: 精度=10位, 測量=2000次

--- 步驟 1: 計算模冪運算基底 ---
  B = C^(n*e) mod n = 70^(539) mod 77 = 14
  使用改進的量子相位估計模擬 (精度=10位, 2000次測量)
  找到乘法階 r = 5

--- 步驟 2: 分析量子相位估計結果 ---
相位測量結果：
  相位：0.199219, 概率：0.2560
  相位：0.799805, 概率：0.2530
  相位：0.599609, 概率：0.2465
  相位：0.399414, 概率：0.2445

從相位中提取可能的r值：
  分析相位 0.199219 (權重:0.2560):
    連分數近似: 51/256, 誤差: 0.000000
    添加r = 256 到候選列表 (評分:0.2560)
  分析相位 0.799805 (權重:0.2530):
    連分數近似: 4/5, 誤差: 0.000195
    添加r = 5 到候選列表 (評分:0.2036)
  分析相位 0.599609 (權重:0.2465):
    連分數近似: 184/307, 誤差: 0.000261
    添加r = 307 到候選列表 (評分:0.1822)
  分析相位 0.399414 (權重:0.2445):
    連分數近似: 123/308, 誤差: 0.000063
    添加r = 308 到候選列表 (評分:0.2290)
  添加理論值 r = 30 到候選列表 (評分:0.5000)
  添加理論值 r = 60 到候選列表 (評分:0.5000)
  添加理論值 r = 15 到候選列表 (評分:0.5000)

排序後的r值候選列表：
  候選 1: r = 30, 評分 = 0.5000
  候選 2: r = 60, 評分 = 0.5000
  候選 3: r = 15, 評分 = 0.5000
  候選 4: r = 256, 評分 = 0.2560
  候選 5: r = 308, 評分 = 0.2290
  候選 6: r = 5, 評分 = 0.2036
  候選 7: r = 307, 評分 = 0.1822

--- 步驟 3: 使用r = 30恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 60恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 15恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 256恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 308恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 5恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 307恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

==================== 攻擊結果 ====================
攻擊失敗，無法恢復明文
用時: 0.00 秒

==================== 測試案例 4: 標準小型RSA(p=7,q=13) ====================
加密: 9^3 mod 91 = 1

==================== RSA量子固定點攻擊 ====================
模數 n = 91
指數 e = 3
密文 C = 1
根據n的大小(7位)設置量子相位估計參數: 精度=10位, 測量=2000次

--- 步驟 1: 計算模冪運算基底 ---
  B = C^(n*e) mod n = 1^(273) mod 91 = 1
  特殊情況: C = 1，這是一個平凡的固定點

==================== 攻擊結果 ====================
成功! 恢復明文 M = 1
方法: 平凡固定點
用時: 0.00 秒

==================== 測試案例 5: 中型RSA(p=11,q=13) ====================
加密: 27^7 mod 143 = 14

==================== RSA量子固定點攻擊 ====================
模數 n = 143
指數 e = 7
密文 C = 14
根據n的大小(8位)設置量子相位估計參數: 精度=10位, 測量=2000次

--- 步驟 1: 計算模冪運算基底 ---
  B = C^(n*e) mod n = 14^(1001) mod 143 = 14
  使用改進的量子相位估計模擬 (精度=10位, 2000次測量)
  找到乘法階 r = 5

--- 步驟 2: 分析量子相位估計結果 ---
相位測量結果：
  相位：0.799805, 概率：0.2650
  相位：0.199219, 概率：0.2540
  相位：0.599609, 概率：0.2405
  相位：0.399414, 概率：0.2405

從相位中提取可能的r值：
  分析相位 0.799805 (權重:0.2650):
    連分數近似: 455/569, 誤差: 0.000156
    添加r = 569 到候選列表 (評分:0.2236)
  分析相位 0.199219 (權重:0.2540):
    連分數近似: 51/256, 誤差: 0.000000
    添加r = 256 到候選列表 (評分:0.2540)
  分析相位 0.599609 (權重:0.2405):
    連分數近似: 307/512, 誤差: 0.000000
    添加r = 512 到候選列表 (評分:0.2405)
  分析相位 0.399414 (權重:0.2405):
    連分數近似: 137/343, 誤差: 0.000003
    添加r = 343 到候選列表 (評分:0.2398)
  添加理論值 r = 60 到候選列表 (評分:0.5000)
  添加理論值 r = 120 到候選列表 (評分:0.5000)
  添加理論值 r = 30 到候選列表 (評分:0.5000)

排序後的r值候選列表：
  候選 1: r = 60, 評分 = 0.5000
  候選 2: r = 120, 評分 = 0.5000
  候選 3: r = 30, 評分 = 0.5000
  候選 4: r = 256, 評分 = 0.2540
  候選 5: r = 512, 評分 = 0.2405
  候選 6: r = 343, 評分 = 0.2398
  候選 7: r = 569, 評分 = 0.2236

--- 步驟 3: 使用r = 60恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 120恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 30恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 256恢復明文 ---
  r值滿足固定點條件: C^(n*e*r) ≡ C (mod n)
  方法: 論文原始公式 => M = 1, 驗證: ✗
  方法: 歐拉定理變體 => M = 92, 驗證: ✗
  方法: 卡邁克爾函數變體 => M = 92, 驗證: ✗
  方法: 調整指數+1 => M = 53, 驗證: ✗
  方法: 調整指數-λ => M = 14, 驗證: ✗
  方法: 卡邁克爾模運算 => M = 92, 驗證: ✗
  方法: 歐拉模運算 => M = 27, 驗證: ✓
  成功使用 歐拉模運算 恢復明文M = 27
  與原始明文匹配: ✓

==================== 攻擊結果 ====================
成功! 恢復明文 M = 27
使用r值: 256 (評分: 0.2540)
用時: 0.00 秒

==================== 測試案例 6: 中型RSA-2(p=11,q=19) ====================
加密: 75^11 mod 209 = 75

==================== RSA量子固定點攻擊 ====================
模數 n = 209
指數 e = 11
密文 C = 75
根據n的大小(8位)設置量子相位估計參數: 精度=10位, 測量=2000次

--- 步驟 1: 計算模冪運算基底 ---
  B = C^(n*e) mod n = 75^(2299) mod 209 = 170
  使用改進的量子相位估計模擬 (精度=10位, 2000次測量)
  找到乘法階 r = 10

--- 步驟 2: 分析量子相位估計結果 ---
相位測量結果：
  相位：0.899414, 概率：0.2560
  相位：0.299805, 概率：0.2500
  相位：0.699219, 概率：0.2480
  相位：0.099609, 概率：0.2460

從相位中提取可能的r值：
  分析相位 0.899414 (權重:0.2560):
    連分數近似: 617/686, 誤差: 0.000003
    添加r = 686 到候選列表 (評分:0.2553)
  分析相位 0.299805 (權重:0.2500):
    連分數近似: 155/517, 誤差: 0.000002
    添加r = 517 到候選列表 (評分:0.2495)
  分析相位 0.699219 (權重:0.2480):
    連分數近似: 179/256, 誤差: 0.000000
    添加r = 256 到候選列表 (評分:0.2480)
  分析相位 0.099609 (權重:0.2460):
    連分數近似: 51/512, 誤差: 0.000000
    添加r = 512 到候選列表 (評分:0.2460)
  添加理論值 r = 90 到候選列表 (評分:0.5000)
  添加理論值 r = 180 到候選列表 (評分:0.5000)
  添加理論值 r = 45 到候選列表 (評分:0.5000)

排序後的r值候選列表：
  候選 1: r = 90, 評分 = 0.5000
  候選 2: r = 180, 評分 = 0.5000
  候選 3: r = 45, 評分 = 0.5000
  候選 4: r = 686, 評分 = 0.2553
  候選 5: r = 517, 評分 = 0.2495
  候選 6: r = 256, 評分 = 0.2480
  候選 7: r = 512, 評分 = 0.2460

--- 步驟 3: 使用r = 90恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 180恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 45恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 686恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 517恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 256恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 512恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

==================== 攻擊結果 ====================
攻擊失敗，無法恢復明文
用時: 0.00 秒

==================== 測試案例 7: 非互質小型RSA ====================
加密: 5^3 mod 55 = 15

==================== RSA量子固定點攻擊 ====================
模數 n = 55
指數 e = 3
密文 C = 15
根據n的大小(6位)設置量子相位估計參數: 精度=10位, 測量=2000次

--- 步驟 1: 計算模冪運算基底 ---
  B = C^(n*e) mod n = 15^(165) mod 55 = 45
  使用改進的量子相位估計模擬 (精度=10位, 2000次測量)
  無法確定乘法階，使用模擬相位分布

--- 步驟 2: 分析量子相位估計結果 ---
相位測量結果：
  相位：0.183594, 概率：0.0075
  相位：0.591797, 概率：0.0070
  相位：0.294922, 概率：0.0065
  相位：0.060547, 概率：0.0065
  相位：0.542969, 概率：0.0065
  相位：0.232422, 概率：0.0060
  相位：0.898438, 概率：0.0055
  相位：0.395508, 概率：0.0055
  相位：0.299805, 概率：0.0055
  相位：0.534180, 概率：0.0055

從相位中提取可能的r值：
  分析相位 0.183594 (權重:0.0075):
    連分數近似: 38/207, 誤差: 0.000019
    添加r = 207 到候選列表 (評分:0.0074)
  分析相位 0.591797 (權重:0.0070):
    連分數近似: 29/49, 誤差: 0.000040
    添加r = 49 到候選列表 (評分:0.0067)
  分析相位 0.294922 (權重:0.0065):
    連分數近似: 64/217, 誤差: 0.000009
    添加r = 217 到候選列表 (評分:0.0064)
  分析相位 0.060547 (權重:0.0065):
    連分數近似: 2/33, 誤差: 0.000059
    添加r = 33 到候選列表 (評分:0.0061)
  分析相位 0.542969 (權重:0.0065):
    連分數近似: 101/186, 誤差: 0.000042
    添加r = 186 到候選列表 (評分:0.0062)
  分析相位 0.232422 (權重:0.0060):
    連分數近似: 43/185, 誤差: 0.000011
    添加r = 185 到候選列表 (評分:0.0059)
  分析相位 0.898438 (權重:0.0055):
    連分數近似: 115/128, 誤差: 0.000000
    添加r = 128 到候選列表 (評分:0.0055)
  分析相位 0.395508 (權重:0.0055):
    連分數近似: 53/134, 誤差: 0.000015
    添加r = 134 到候選列表 (評分:0.0054)
  分析相位 0.299805 (權重:0.0055):
    連分數近似: 3/10, 誤差: 0.000195
    添加r = 10 到候選列表 (評分:0.0044)
  分析相位 0.534180 (權重:0.0055):
    連分數近似: 86/161, 誤差: 0.000018
    添加r = 161 到候選列表 (評分:0.0054)
  分析相位 0.070312 (權重:0.0055):
    連分數近似: 9/128, 誤差: 0.000000
    添加r = 128 到候選列表 (評分:0.0055)
  分析相位 0.644531 (權重:0.0055):
    連分數近似: 136/211, 誤差: 0.000019
    添加r = 211 到候選列表 (評分:0.0054)
  分析相位 0.901367 (權重:0.0050):
    連分數近似: 64/71, 誤差: 0.000041
    添加r = 71 到候選列表 (評分:0.0048)
  分析相位 0.025391 (權重:0.0050):
    連分數近似: 5/197, 誤差: 0.000010
    添加r = 197 到候選列表 (評分:0.0050)
  分析相位 0.573242 (權重:0.0050):
    連分數近似: 90/157, 誤差: 0.000006
    添加r = 157 到候選列表 (評分:0.0050)
  分析相位 0.224609 (權重:0.0050):
    連分數近似: 42/187, 誤差: 0.000010
    添加r = 187 到候選列表 (評分:0.0049)
  分析相位 0.760742 (權重:0.0045):
    連分數近似: 124/163, 誤差: 0.000006
    添加r = 163 到候選列表 (評分:0.0045)
  分析相位 0.209961 (權重:0.0045):
    連分數近似: 38/181, 誤差: 0.000016
    添加r = 181 到候選列表 (評分:0.0044)
  分析相位 0.033203 (權重:0.0045):
    連分數近似: 7/211, 誤差: 0.000028
    添加r = 211 到候選列表 (評分:0.0044)
  分析相位 0.120117 (權重:0.0045):
    連分數近似: 25/208, 誤差: 0.000075
    添加r = 208 到候選列表 (評分:0.0042)
  分析相位 0.815430 (權重:0.0045):
    連分數近似: 53/65, 誤差: 0.000045
    添加r = 65 到候選列表 (評分:0.0043)
  分析相位 0.826172 (權重:0.0045):
    連分數近似: 19/23, 誤差: 0.000085
    添加r = 23 到候選列表 (評分:0.0041)
  分析相位 0.391602 (權重:0.0045):
    連分數近似: 56/143, 誤差: 0.000007
    添加r = 143 到候選列表 (評分:0.0045)
  分析相位 0.975586 (權重:0.0045):
    連分數近似: 40/41, 誤差: 0.000024
    添加r = 41 到候選列表 (評分:0.0044)
  分析相位 0.741211 (權重:0.0045):
    連分數近似: 63/85, 誤差: 0.000034
    添加r = 85 到候選列表 (評分:0.0043)
  分析相位 0.189453 (權重:0.0045):
    連分數近似: 18/95, 誤差: 0.000021
    添加r = 95 到候選列表 (評分:0.0044)
  分析相位 0.638672 (權重:0.0045):
    連分數近似: 76/119, 誤差: 0.000016
    添加r = 119 到候選列表 (評分:0.0044)
  分析相位 0.619141 (權重:0.0045):
    連分數近似: 13/21, 誤差: 0.000093
    添加r = 21 到候選列表 (評分:0.0041)
  分析相位 0.891602 (權重:0.0040):
    連分數近似: 181/203, 誤差: 0.000024
    添加r = 203 到候選列表 (評分:0.0039)
  添加理論值 r = 20 到候選列表 (評分:0.5000)
  添加理論值 r = 40 到候選列表 (評分:0.5000)

排序後的r值候選列表：
  候選 1: r = 20, 評分 = 0.5000
  候選 2: r = 40, 評分 = 0.5000
  候選 3: r = 207, 評分 = 0.0074
  候選 4: r = 49, 評分 = 0.0067
  候選 5: r = 217, 評分 = 0.0064
  候選 6: r = 186, 評分 = 0.0062
  候選 7: r = 33, 評分 = 0.0061
  候選 8: r = 185, 評分 = 0.0059
  候選 9: r = 128, 評分 = 0.0055
  候選 10: r = 128, 評分 = 0.0055

--- 步驟 3: 使用r = 20恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 40恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 207恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 49恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 217恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 186恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 33恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 185恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 128恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 128恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 134恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 161恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 211恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 157恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 197恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 187恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 71恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 163恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 143恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 181恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

==================== 攻擊結果 ====================
攻擊失敗，無法恢復明文
用時: 0.02 秒

==================== 測試案例 8: 非互質中型RSA(p=13,q=19) ====================
加密: 19^3 mod 247 = 190

==================== RSA量子固定點攻擊 ====================
模數 n = 247
指數 e = 3
密文 C = 190
根據n的大小(8位)設置量子相位估計參數: 精度=10位, 測量=2000次

--- 步驟 1: 計算模冪運算基底 ---
  B = C^(n*e) mod n = 190^(741) mod 247 = 190
  使用改進的量子相位估計模擬 (精度=10位, 2000次測量)
  找到乘法階 r = 4

--- 步驟 2: 分析量子相位估計結果 ---
相位測量結果：
  相位：0.249023, 概率：0.5170
  相位：0.749023, 概率：0.4830

從相位中提取可能的r值：
  分析相位 0.249023 (權重:0.5170):
    連分數近似: 191/767, 誤差: 0.000001
    添加r = 767 到候選列表 (評分:0.5163)
  分析相位 0.749023 (權重:0.4830):
    連分數近似: 576/769, 誤差: 0.000001
    添加r = 769 到候選列表 (評分:0.4824)
  添加理論值 r = 36 到候選列表 (評分:0.5000)
  添加理論值 r = 216 到候選列表 (評分:0.5000)
  添加理論值 r = 18 到候選列表 (評分:0.5000)
  添加理論值 r = 108 到候選列表 (評分:0.5000)

排序後的r值候選列表：
  候選 1: r = 767, 評分 = 0.5163
  候選 2: r = 36, 評分 = 0.5000
  候選 3: r = 216, 評分 = 0.5000
  候選 4: r = 18, 評分 = 0.5000
  候選 5: r = 108, 評分 = 0.5000
  候選 6: r = 769, 評分 = 0.4824

--- 步驟 3: 使用r = 767恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 36恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 216恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 18恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 108恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 769恢復明文 ---
  r值滿足固定點條件: C^(n*e*r) ≡ C (mod n)
  方法: 論文原始公式 => M = 209, 驗證: ✗
  方法: 歐拉定理變體 => M = 57, 驗證: ✓
  成功使用 歐拉定理變體 恢復明文M = 57
  與原始明文匹配: ✗

==================== 攻擊結果 ====================
成功! 恢復明文 M = 57
使用r值: 769 (評分: 0.4824)
用時: 0.00 秒

==================== 測試案例 9: 較大中型RSA(p=13,q=23) ====================
加密: 123^5 mod 299 = 223

==================== RSA量子固定點攻擊 ====================
模數 n = 299
指數 e = 5
密文 C = 223
根據n的大小(9位)設置量子相位估計參數: 精度=11位, 測量=2000次

--- 步驟 1: 計算模冪運算基底 ---
  B = C^(n*e) mod n = 223^(1495) mod 299 = 128
  使用改進的量子相位估計模擬 (精度=11位, 2000次測量)
  找到乘法階 r = 132

--- 步驟 2: 分析量子相位估計結果 ---
相位測量結果：
  相位：0.825684, 概率：0.0335
  相位：0.507324, 概率：0.0335
  相位：0.173828, 概率：0.0295
  相位：0.780273, 概率：0.0290
  相位：0.143555, 概率：0.0285
  相位：0.371094, 概率：0.0285
  相位：0.037598, 概率：0.0280
  相位：0.098145, 概率：0.0280
  相位：0.855957, 概率：0.0280
  相位：0.128418, 概率：0.0280

從相位中提取可能的r值：
  分析相位 0.825684 (權重:0.0335):
    連分數近似: 971/1176, 誤差: 0.000003
    添加r = 1176 到候選列表 (評分:0.0334)
  分析相位 0.507324 (權重:0.0335):
    連分數近似: 381/751, 誤差: 0.000001
    添加r = 751 到候選列表 (評分:0.0335)
  分析相位 0.173828 (權重:0.0295):
    連分數近似: 89/512, 誤差: 0.000000
    添加r = 512 到候選列表 (評分:0.0295)
  分析相位 0.780273 (權重:0.0290):
    連分數近似: 799/1024, 誤差: 0.000000
    添加r = 1024 到候選列表 (評分:0.0290)
  分析相位 0.143555 (權重:0.0285):
    連分數近似: 147/1024, 誤差: 0.000000
    添加r = 1024 到候選列表 (評分:0.0285)
  分析相位 0.371094 (權重:0.0285):
    連分數近似: 95/256, 誤差: 0.000000
    添加r = 256 到候選列表 (評分:0.0285)
  分析相位 0.037598 (權重:0.0280):
    連分數近似: 42/1117, 誤差: 0.000003
    添加r = 1117 到候選列表 (評分:0.0279)
  分析相位 0.098145 (權重:0.0280):
    連分數近似: 37/377, 誤差: 0.000001
    添加r = 377 到候選列表 (評分:0.0280)
  分析相位 0.855957 (權重:0.0280):
    連分數近似: 309/361, 誤差: 0.000001
    添加r = 361 到候選列表 (評分:0.0280)
  分析相位 0.128418 (權重:0.0280):
    連分數近似: 108/841, 誤差: 0.000001
    添加r = 841 到候選列表 (評分:0.0280)
  分析相位 0.901367 (權重:0.0270):
    連分數近似: 923/1024, 誤差: 0.000000
    添加r = 1024 到候選列表 (評分:0.0270)
  分析相位 0.765137 (權重:0.0265):
    連分數近似: 417/545, 誤差: 0.000001
    添加r = 545 到候選列表 (評分:0.0265)
  分析相位 0.734375 (權重:0.0265):
    連分數近似: 47/64, 誤差: 0.000000
    添加r = 64 到候選列表 (評分:0.0265)
  分析相位 0.810547 (權重:0.0265):
    連分數近似: 415/512, 誤差: 0.000000
    添加r = 512 到候選列表 (評分:0.0265)
  分析相位 0.961914 (權重:0.0260):
    連分數近似: 985/1024, 誤差: 0.000000
    添加r = 1024 到候選列表 (評分:0.0260)
  分析相位 0.537598 (權重:0.0260):
    連分數近似: 622/1157, 誤差: 0.000000
    添加r = 1157 到候選列表 (評分:0.0260)
  分析相位 0.628418 (權重:0.0255):
    連分數近似: 712/1133, 誤差: 0.000002
    添加r = 1133 到候選列表 (評分:0.0254)
  分析相位 0.280273 (權重:0.0255):
    連分數近似: 287/1024, 誤差: 0.000000
    添加r = 1024 到候選列表 (評分:0.0255)
  分析相位 0.325684 (權重:0.0250):
    連分數近似: 369/1133, 誤差: 0.000000
    添加r = 1133 到候選列表 (評分:0.0250)
  分析相位 0.492188 (權重:0.0250):
    連分數近似: 63/128, 誤差: 0.000000
    添加r = 128 到候選列表 (評分:0.0250)
  分析相位 0.355957 (權重:0.0250):
    連分數近似: 236/663, 誤差: 0.000001
    添加r = 663 到候選列表 (評分:0.0250)
  分析相位 0.673828 (權重:0.0245):
    連分數近似: 345/512, 誤差: 0.000000
    添加r = 512 到候選列表 (評分:0.0245)
  分析相位 0.688965 (權重:0.0240):
    連分數近似: 793/1151, 誤差: 0.000001
    添加r = 1151 到候選列表 (評分:0.0240)
  分析相位 0.719238 (權重:0.0240):
    連分數近似: 415/577, 誤差: 0.000001
    添加r = 577 到候選列表 (評分:0.0240)
  分析相位 0.446777 (權重:0.0240):
    連分數近似: 298/667, 誤差: 0.000001
    添加r = 667 到候選列表 (評分:0.0240)
  分析相位 0.219238 (權重:0.0240):
    連分數近似: 253/1154, 誤差: 0.000001
    添加r = 1154 到候選列表 (評分:0.0240)
  分析相位 0.052734 (權重:0.0235):
    連分數近似: 27/512, 誤差: 0.000000
    添加r = 512 到候選列表 (評分:0.0235)
  分析相位 0.188965 (權重:0.0235):
    連分數近似: 137/725, 誤差: 0.000001
    添加r = 725 到候選列表 (評分:0.0235)
  分析相位 0.946777 (權重:0.0235):
    連分數近似: 338/357, 誤差: 0.000001
    添加r = 357 到候選列表 (評分:0.0235)
  分析相位 0.552734 (權重:0.0235):
    連分數近似: 283/512, 誤差: 0.000000
    添加r = 512 到候選列表 (評分:0.0235)
  添加理論值 r = 132 到候選列表 (評分:0.5000)
  添加理論值 r = 264 到候選列表 (評分:0.5000)
  添加理論值 r = 66 到候選列表 (評分:0.5000)

排序後的r值候選列表：
  候選 1: r = 132, 評分 = 0.5000
  候選 2: r = 264, 評分 = 0.5000
  候選 3: r = 66, 評分 = 0.5000
  候選 4: r = 751, 評分 = 0.0335
  候選 5: r = 1176, 評分 = 0.0334
  候選 6: r = 512, 評分 = 0.0295
  候選 7: r = 1024, 評分 = 0.0290
  候選 8: r = 1024, 評分 = 0.0285
  候選 9: r = 256, 評分 = 0.0285
  候選 10: r = 841, 評分 = 0.0280

--- 步驟 3: 使用r = 132恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 264恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 66恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 751恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 1176恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 512恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 1024恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 1024恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 256恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 841恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 377恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 361恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 1117恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 1024恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 64恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 512恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 545恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 1024恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 1157恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 1024恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

==================== 攻擊結果 ====================
攻擊失敗，無法恢復明文
用時: 0.00 秒

==================== 測試案例 10: 最大測試案例(p=17,q=23) ====================
加密: 200^3 mod 391 = 140

==================== RSA量子固定點攻擊 ====================
模數 n = 391
指數 e = 3
密文 C = 140
根據n的大小(9位)設置量子相位估計參數: 精度=11位, 測量=2000次

--- 步驟 1: 計算模冪運算基底 ---
  B = C^(n*e) mod n = 140^(1173) mod 391 = 174
  使用改進的量子相位估計模擬 (精度=11位, 2000次測量)
  找到乘法階 r = 44

--- 步驟 2: 分析量子相位估計結果 ---
相位測量結果：
  相位：0.022461, 概率：0.0590
  相位：0.977051, 概率：0.0580
  相位：0.840820, 概率：0.0535
  相位：0.386230, 概率：0.0535
  相位：0.340820, 概率：0.0535
  相位：0.204102, 概率：0.0520
  相位：0.931641, 概率：0.0520
  相位：0.067871, 概率：0.0510
  相位：0.477051, 概率：0.0510
  相位：0.704102, 概率：0.0505

從相位中提取可能的r值：
  分析相位 0.022461 (權重:0.0590):
    連分數近似: 23/1024, 誤差: 0.000000
    添加r = 1024 到候選列表 (評分:0.0590)
  分析相位 0.977051 (權重:0.0580):
    連分數近似: 1405/1438, 誤差: 0.000001
    添加r = 1438 到候選列表 (評分:0.0580)
  分析相位 0.840820 (權重:0.0535):
    連分數近似: 861/1024, 誤差: 0.000000
    添加r = 1024 到候選列表 (評分:0.0535)
  分析相位 0.386230 (權重:0.0535):
    連分數近似: 460/1191, 誤差: 0.000000
    添加r = 1191 到候選列表 (評分:0.0535)
  分析相位 0.340820 (權重:0.0535):
    連分數近似: 349/1024, 誤差: 0.000000
    添加r = 1024 到候選列表 (評分:0.0535)
  分析相位 0.204102 (權重:0.0520):
    連分數近似: 209/1024, 誤差: 0.000000
    添加r = 1024 到候選列表 (評分:0.0520)
  分析相位 0.931641 (權重:0.0520):
    連分數近似: 477/512, 誤差: 0.000000
    添加r = 512 到候選列表 (評分:0.0520)
  分析相位 0.067871 (權重:0.0510):
    連分數近似: 94/1385, 誤差: 0.000001
    添加r = 1385 到候選列表 (評分:0.0509)
  分析相位 0.477051 (權重:0.0510):
    連分數近似: 634/1329, 誤差: 0.000000
    添加r = 1329 到候選列表 (評分:0.0510)
  分析相位 0.704102 (權重:0.0505):
    連分數近似: 721/1024, 誤差: 0.000000
    添加r = 1024 到候選列表 (評分:0.0505)
  分析相位 0.295410 (權重:0.0490):
    連分數近似: 457/1547, 誤差: 0.000000
    添加r = 1547 到候選列表 (評分:0.0490)
  分析相位 0.522461 (權重:0.0485):
    連分數近似: 535/1024, 誤差: 0.000000
    添加r = 1024 到候選列表 (評分:0.0485)
  分析相位 0.658691 (權重:0.0480):
    連分數近似: 936/1421, 誤差: 0.000000
    添加r = 1421 到候選列表 (評分:0.0480)
  分析相位 0.113281 (權重:0.0475):
    連分數近似: 29/256, 誤差: 0.000000
    添加r = 256 到候選列表 (評分:0.0475)
  分析相位 0.567871 (權重:0.0475):
    連分數近似: 707/1245, 誤差: 0.000000
    添加r = 1245 到候選列表 (評分:0.0475)
  分析相位 0.431641 (權重:0.0470):
    連分數近似: 221/512, 誤差: 0.000000
    添加r = 512 到候選列表 (評分:0.0470)
  分析相位 0.795410 (權重:0.0470):
    連分數近似: 1213/1525, 誤差: 0.000000
    添加r = 1525 到候選列表 (評分:0.0470)
  分析相位 0.613281 (權重:0.0465):
    連分數近似: 157/256, 誤差: 0.000000
    添加r = 256 到候選列表 (評分:0.0465)
  分析相位 0.158691 (權重:0.0435):
    連分數近似: 199/1254, 誤差: 0.000001
    添加r = 1254 到候選列表 (評分:0.0435)
  分析相位 0.886230 (權重:0.0415):
    連分數近似: 1371/1547, 誤差: 0.000001
    添加r = 1547 到候選列表 (評分:0.0415)
  添加理論值 r = 176 到候選列表 (評分:0.5000)
  添加理論值 r = 352 到候選列表 (評分:0.5000)
  添加理論值 r = 88 到候選列表 (評分:0.5000)

排序後的r值候選列表：
  候選 1: r = 176, 評分 = 0.5000
  候選 2: r = 352, 評分 = 0.5000
  候選 3: r = 88, 評分 = 0.5000
  候選 4: r = 1024, 評分 = 0.0590
  候選 5: r = 1438, 評分 = 0.0580
  候選 6: r = 1024, 評分 = 0.0535
  候選 7: r = 1024, 評分 = 0.0535
  候選 8: r = 1191, 評分 = 0.0535
  候選 9: r = 1024, 評分 = 0.0520
  候選 10: r = 512, 評分 = 0.0520

--- 步驟 3: 使用r = 176恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 352恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 88恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 1024恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 1438恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 1024恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 1024恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 1191恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 1024恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 512恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 1329恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 1385恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 1024恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 1547恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 1024恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 1421恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 256恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 1245恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 512恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

--- 步驟 3: 使用r = 1525恢復明文 ---
  r值不滿足固定點條件，不適用於恢復明文

==================== 攻擊結果 ====================
攻擊失敗，無法恢復明文
用時: 0.00 秒

==================== 測試結果摘要 ====================
| 案例 | 描述 | n | e | 原文 | 密文 | 成功? | 恢復明文 | r值 | 用時(秒) |
|------|------|---|---|------|------|-------|----------|-----|----------|
| 1 | 微型RSA(p=3,q=5) | 15 | 3 | 4 | 4 | ✗ | N/A | N/A | 0.00 |
| 2 | 小型RSA(p=5,q=7) | 35 | 5 | 6 | 6 | ✗ | N/A | N/A | 0.00 |
| 3 | 較小RSA(p=7,q=11) | 77 | 7 | 42 | 70 | ✗ | N/A | N/A | 0.00 |
| 4 | 標準小型RSA(p=7,q=13) | 91 | 3 | 9 | 1 | ✓ | 1 | 1 | 0.00 |
| 5 | 中型RSA(p=11,q=13) | 143 | 7 | 27 | 14 | ✓ | 27 | 256 | 0.00 |
| 6 | 中型RSA-2(p=11,q=19) | 209 | 11 | 75 | 75 | ✗ | N/A | N/A | 0.00 |
| 7 | 非互質小型RSA | 55 | 3 | 5 | 15 | ✗ | N/A | N/A | 0.02 |
| 8 | 非互質中型RSA(p=13,q=19) | 247 | 3 | 19 | 190 | ✓ | 57 | 769 | 0.00 |
| 9 | 較大中型RSA(p=13,q=23) | 299 | 5 | 123 | 223 | ✗ | N/A | N/A | 0.00 |
| 10 | 最大測試案例(p=17,q=23) | 391 | 3 | 200 | 140 | ✗ | N/A | N/A | 0.00 |

成功率: 3/10 = 30.0%
當前日期時間: 2025-04-14 22:11:11
當前用戶: RogerLiao0001
(env2) roger@liaozhichendeMacBook-Air py % 
