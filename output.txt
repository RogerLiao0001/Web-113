(env2) roger@liaozhichendeMacBook-Air py % python pyqclaude2.py
成功導入 PyQPanda
PyQPanda RSA量子固定點攻擊 - 純量子方法版
當前日期時間: 2025-04-14 21:38:43
當前用戶: RogerLiao0001

==================================================
開始RSA量子固定點攻擊測試 - 10組不同大小
當前日期時間: 2025-04-14 21:38:43
當前用戶: RogerLiao0001
==================================================


==================== 測試案例 1: 微型RSA(p=3,q=5) ====================
加密: 4^3 mod 15 = 4

==================== RSA量子固定點攻擊 ====================
模數 n = 15
指數 e = 3
密文 C = 4
根據n的大小(4位)，分配資源: 精度=10位, 測量=3600次
  特殊情況: C^e ≡ C (mod n)，C=4是RSA固定點

==================== 攻擊結果 ====================
成功! 恢復明文 M = 4
方法: 固定點特例
用時: 0.00 秒

==================== 測試案例 2: 小型RSA(p=5,q=7) ====================
加密: 6^5 mod 35 = 6

==================== RSA量子固定點攻擊 ====================
模數 n = 35
指數 e = 5
密文 C = 6
根據n的大小(6位)，分配資源: 精度=10位, 測量=4400次
  特殊情況: C^e ≡ C (mod n)，C=6是RSA固定點

==================== 攻擊結果 ====================
成功! 恢復明文 M = 6
方法: 固定點特例
用時: 0.00 秒

==================== 測試案例 3: 較小RSA(p=7,q=11) ====================
加密: 42^7 mod 77 = 70

==================== RSA量子固定點攻擊 ====================
模數 n = 77
指數 e = 7
密文 C = 70
根據n的大小(7位)，分配資源: 精度=10位, 測量=4800次

--- 步驟 1: 理論分析RSA參數 ---
  φ(n) = 60
  尋找滿足固定點條件的r值...
  計算B = C^(n*e) mod n = 14
  注意: a=14與n=77不互質，使用強化計算方法
  在模11下找到3的乘法階: 5
  找到B的(廣義)乘法階: 5
  搜索乘法階5的因數...
  通過乘法階未找到足夠的r值，使用直接搜索...
  從搜索添加r = 4
  從搜索添加r = 9
  從搜索添加r = 14
  從搜索添加r = 19
  從搜索添加r = 24
  從搜索添加r = 29
  從搜索添加r = 34
  從搜索添加r = 39
  從搜索添加r = 44
  從搜索添加r = 49
  從搜索添加r = 84
  從搜索添加r = 119
  從搜索添加r = 154
  從搜索添加r = 189
  從搜索添加r = 224
  理論分析找到的r值: [4, 9, 14, 19, 24, 29, 34, 39, 44, 49]...

--- 步驟 2: 執行量子相位估計 (精度=10, 測量=4800次) ---
  模冪基底 B = C^(n*e) mod n = 14
  使用增強版量子相位估計模擬 (精度=10位, 4800次測量)
  注意: a=14與n=77不互質，使用強化計算方法
  在模11下找到3的乘法階: 5
  找到乘法階 r = 5
  增強相位估計模擬出錯: sum(): incompatible function arguments. The following argument types are supported:
    1. (arg0: pyqpanda.pyQPanda.var) -> pyqpanda.pyQPanda.var

Invoked with: dict_values([0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.0005993570594107056, 0.0027340440922418107, 0.0075705688354284675, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.000951487074501094, 0.0011778283678367518, 0.0035986895522423213, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.005396523378716834, 0.0011342163721235422, 0.004807512399497394, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.005211123204457991, 0.009499661442915695, 0.005661491630108524])

--- 步驟 3: 分析量子相位估計結果 ---
主要相位測量結果:
  相位值: 0.688477, 概率: 0.0027
  相位值: 0.952148, 概率: 0.0025
  相位值: 0.151367, 概率: 0.0025
  相位值: 0.004883, 概率: 0.0025
  相位值: 0.620117, 概率: 0.0023
  相位值: 0.263672, 概率: 0.0023
  相位值: 0.790039, 概率: 0.0023
  相位值: 0.589844, 概率: 0.0023
  相位值: 0.833984, 概率: 0.0021
  相位值: 0.742188, 概率: 0.0021

尋找可能的r值:
  分析相位 0.688477(權重:0.0027):
    分數近似: 42/61, 誤差: 0.000048, 有效: ✗
    分數近似: 484/703, 誤差: 0.000001, 有效: ✗
    分數近似: 705/1024, 誤差: 0.000000, 有效: ✓, 評分:0.0027
    添加r=1024到候選列表 (評分:0.0027)
  分析相位 0.952148(權重:0.0025):
    分數近似: 20/21, 誤差: 0.000233, 有效: ✗
    分數近似: 577/606, 誤差: 0.000003, 有效: ✗
  分析相位 0.151367(權重:0.0025):
    分數近似: 5/33, 誤差: 0.000148, 有效: ✗
    分數近似: 94/621, 誤差: 0.000002, 有效: ✗
  分析相位 0.620117(權重:0.0023):
    分數近似: 31/50, 誤差: 0.000117, 有效: ✗
    分數近似: 413/666, 誤差: 0.000003, 有效: ✗
  分析相位 0.263672(權重:0.0023):
    分數近似: 24/91, 誤差: 0.000064, 有效: ✗
    分數近似: 135/512, 誤差: 0.000000, 有效: ✗
  分析相位 0.790039(權重:0.0023):
    分數近似: 79/100, 誤差: 0.000039, 有效: ✗
    分數近似: 587/743, 誤差: 0.000001, 有效: ✗
  分析相位 0.589844(權重:0.0023):
    分數近似: 23/39, 誤差: 0.000100, 有效: ✓, 評分:0.0023
    添加r=39到候選列表 (評分:0.0023)
    分數近似: 151/256, 誤差: 0.000000, 有效: ✗
  分析相位 0.833984(權重:0.0021):
    分數近似: 5/6, 誤差: 0.000651, 有效: ✗
  分析相位 0.742188(權重:0.0021):
    分數近似: 72/97, 誤差: 0.000081, 有效: ✗
    分數近似: 95/128, 誤差: 0.000000, 有效: ✗
  分析相位 0.976562(權重:0.0021):
    分數近似: 83/85, 誤差: 0.000092, 有效: ✗
  分析相位 0.757812(權重:0.0021):
    分數近似: 72/95, 誤差: 0.000082, 有效: ✗
  分析相位 0.894531(權重:0.0021):
    分數近似: 17/19, 誤差: 0.000206, 有效: ✓, 評分:0.0020
    添加r=19到候選列表 (評分:0.0020)
  分析相位 0.356445(權重:0.0021):
    分數近似: 31/87, 誤差: 0.000123, 有效: ✗
    分數近似: 257/721, 誤差: 0.000004, 有效: ✗
  分析相位 0.848633(權重:0.0021):
  分析相位 0.960938(權重:0.0021):
    分數近似: 74/77, 誤差: 0.000101, 有效: ✗
  分析相位 0.417969(權重:0.0021):
    分數近似: 28/67, 誤差: 0.000058, 有效: ✗
  分析相位 0.042969(權重:0.0021):
    分數近似: 4/93, 誤差: 0.000042, 有效: ✗
  分析相位 0.549805(權重:0.0021):
    分數近似: 11/20, 誤差: 0.000195, 有效: ✗
    分數近似: 287/522, 誤差: 0.000004, 有效: ✗
  分析相位 0.989258(權重:0.0019):
    分數近似: 737/745, 誤差: 0.000004, 有效: ✗
  分析相位 0.092773(權重:0.0019):
    分數近似: 68/733, 誤差: 0.000004, 有效: ✗
  分析相位 0.407227(權重:0.0019):
    分數近似: 11/27, 誤差: 0.000181, 有效: ✗
    分數近似: 248/609, 誤差: 0.000002, 有效: ✓, 評分:0.0019
    添加r=609到候選列表 (評分:0.0019)
  分析相位 0.075195(權重:0.0019):
    分數近似: 57/758, 誤差: 0.000003, 有效: ✗
  分析相位 0.473633(權重:0.0019):
  分析相位 0.025391(權重:0.0019):
    分數近似: 2/79, 誤差: 0.000074, 有效: ✓, 評分:0.0019
    添加r=79到候選列表 (評分:0.0019)
  分析相位 0.565430(權重:0.0019):
    分數近似: 13/23, 誤差: 0.000212, 有效: ✗
    分數近似: 350/619, 誤差: 0.000002, 有效: ✓, 評分:0.0019
    添加r=619到候選列表 (評分:0.0019)
  分析相位 0.087891(權重:0.0019):
  分析相位 0.353516(權重:0.0019):
    分數近似: 35/99, 誤差: 0.000020, 有效: ✓, 評分:0.0019
    添加r=99到候選列表 (評分:0.0019)
  分析相位 0.381836(權重:0.0019):
    分數近似: 21/55, 誤差: 0.000018, 有效: ✗
    分數近似: 286/749, 誤差: 0.000007, 有效: ✓, 評分:0.0019
    添加r=749到候選列表 (評分:0.0019)
  分析相位 0.732422(權重:0.0019):
    分數近似: 52/71, 誤差: 0.000028, 有效: ✗

排序後的r值候選列表:
  優先級1: r = 1024, 評分 = 0.0027
  優先級2: r = 39, 評分 = 0.0023
  優先級3: r = 19, 評分 = 0.0020
  優先級4: r = 619, 評分 = 0.0019
  優先級5: r = 609, 評分 = 0.0019
  優先級6: r = 749, 評分 = 0.0019
  優先級7: r = 99, 評分 = 0.0019
  優先級8: r = 79, 評分 = 0.0019

最終r值候選列表: [4, 9, 14, 24, 1024, 39, 19, 619, 609, 749]...

--- 步驟 4: 使用r=4恢復明文 ---
  固定點條件檢查: C^(n*e*r) ≡ C (mod n): ✓
  方法1: M = C^(n*e*r-1) mod n = 70^(2155) mod 77 = 56, 驗證: ✗
  方法2: M = C^(phi(n)*e*r-1) mod n = 70^(1679) mod 77 = 14, 驗證: ✗
  方法3: M = C^(λ(n)*e*r-1) mod n = 70^(839) mod 77 = 14, 驗證: ✗
  方法5: M = C^(n*e*r+1) mod n = 70^(2157) mod 77 = 49, 驗證: ✗
  方法6: M = C^((n-r)*e) mod n = 70^(511) mod 77 = 70, 驗證: ✗
  方法7: M = C^(phi(n)*(r%phi(n))-1) mod n = 70^(239) mod 77 = 14, 驗證: ✗
  方法8: M = C^(n*e*r-λ(n)) mod n = 70^(2126) mod 77 = 70, 驗證: ✗
  方法9: 注意到gcd(C,n)=7，使用模運算推導
  方法9: 使用d=43計算M = C^d mod n = 42, 驗證: ✓
  方法10: r=4是2的冪，使用特殊處理
  方法10: M = C^((r*e*n)/2-1) mod n = 70^(1077) mod 77 = 49, 驗證: ✗
  注意: a=70與n=77不互質，使用強化計算方法
  在模11下找到4的乘法階: 5
  方法11: C在模77下的順序為5
  方法12: M = C^((λ(n)*r)%n) mod n = 70^(43) mod 77 = 42, 驗證: ✓
  成功使用模運算推導恢復明文M = 42 (評分:0.85)

==================== 攻擊結果 ====================
成功! 恢復明文 M = 42
使用r值: 4
使用方法: 模運算推導
與原始明文匹配: ✓
用時: 0.01 秒

==================== 測試案例 4: 標準小型RSA(p=7,q=13) ====================
加密: 9^3 mod 91 = 1

==================== RSA量子固定點攻擊 ====================
模數 n = 91
指數 e = 3
密文 C = 1
根據n的大小(7位)，分配資源: 精度=10位, 測量=4800次
  特殊情況: C^e ≡ C (mod n)，C=1是RSA固定點

==================== 攻擊結果 ====================
成功! 恢復明文 M = 1
方法: 固定點特例
用時: 0.00 秒

==================== 測試案例 5: 中型RSA(p=11,q=13) ====================
加密: 27^7 mod 143 = 14

==================== RSA量子固定點攻擊 ====================
模數 n = 143
指數 e = 7
密文 C = 14
根據n的大小(8位)，分配資源: 精度=12位, 測量=5200次

--- 步驟 1: 理論分析RSA參數 ---
  φ(n) = 120
  尋找滿足固定點條件的r值...
  計算B = C^(n*e) mod n = 14
  找到B的(廣義)乘法階: 5
  搜索乘法階5的因數...
  添加乘法階因數r = 1
  通過乘法階未找到足夠的r值，使用直接搜索...
  從搜索添加r = 6
  從搜索添加r = 11
  從搜索添加r = 16
  從搜索添加r = 21
  從搜索添加r = 26
  從搜索添加r = 31
  從搜索添加r = 36
  從搜索添加r = 41
  從搜索添加r = 46
  從搜索添加r = 56
  從搜索添加r = 91
  從搜索添加r = 126
  從搜索添加r = 161
  從搜索添加r = 196
  從搜索添加r = 231
  理論分析找到的r值: [1, 6, 11, 16, 21, 26, 31, 36, 41, 46]...

--- 步驟 2: 執行量子相位估計 (精度=12, 測量=5200次) ---
  模冪基底 B = C^(n*e) mod n = 14
  使用增強版量子相位估計模擬 (精度=12位, 5200次測量)
  找到乘法階 r = 5
  增強相位估計模擬出錯: sum(): incompatible function arguments. The following argument types are supported:
    1. (arg0: pyqpanda.pyQPanda.var) -> pyqpanda.pyQPanda.var

Invoked with: dict_values([0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.008119670847228843, 0.00014965831178979428, 0.008256924018793245, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.003914994913877201, 0.00586232137659667, 0.005794239694058891, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.0014434959375926471, 0.00844713055025287, 0.0076894137419832465, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.004479080088791043, 0.001656255078865191, 0.004009760238350304])

--- 步驟 3: 分析量子相位估計結果 ---
主要相位測量結果:
  相位值: 0.555908, 概率: 0.0013
  相位值: 0.045898, 概率: 0.0013
  相位值: 0.810303, 概率: 0.0013
  相位值: 0.440186, 概率: 0.0012
  相位值: 0.461670, 概率: 0.0012
  相位值: 0.404541, 概率: 0.0012
  相位值: 0.251465, 概率: 0.0012
  相位值: 0.209229, 概率: 0.0012
  相位值: 0.590820, 概率: 0.0012
  相位值: 0.659912, 概率: 0.0012

尋找可能的r值:
  分析相位 0.555908(權重:0.0013):
    分數近似: 5/9, 誤差: 0.000353, 有效: ✗
    分數近似: 701/1261, 誤差: 0.000000, 有效: ✓, 評分:0.0013
    添加r=1261到候選列表 (評分:0.0013)
    分數近似: 2277/4096, 誤差: 0.000000, 有效: ✓, 評分:0.0013
    添加r=4096到候選列表 (評分:0.0013)
  分析相位 0.045898(權重:0.0013):
    分數近似: 4/87, 誤差: 0.000079, 有效: ✗
    分數近似: 47/1024, 誤差: 0.000000, 有效: ✗
  分析相位 0.810303(權重:0.0013):
    分數近似: 47/58, 誤差: 0.000042, 有效: ✗
    分數近似: 991/1223, 誤差: 0.000000, 有效: ✗
  分析相位 0.440186(權重:0.0012):
    分數近似: 11/25, 誤差: 0.000186, 有效: ✗
    分數近似: 379/861, 誤差: 0.000000, 有效: ✓, 評分:0.0012
    添加r=861到候選列表 (評分:0.0012)
  分析相位 0.461670(權重:0.0012):
    分數近似: 6/13, 誤差: 0.000131, 有效: ✗
    分數近似: 271/587, 誤差: 0.000000, 有效: ✗
  分析相位 0.404541(權重:0.0012):
    分數近似: 36/89, 誤差: 0.000047, 有效: ✗
    分數近似: 392/969, 誤差: 0.000000, 有效: ✗
  分析相位 0.251465(權重:0.0012):
    分數近似: 25/99, 誤差: 0.001060, 有效: ✗
    分數近似: 343/1364, 誤差: 0.000001, 有效: ✗
    分數近似: 515/2048, 誤差: 0.000000, 有效: ✗
  分析相位 0.209229(權重:0.0012):
    分數近似: 9/43, 誤差: 0.000074, 有效: ✗
    分數近似: 263/1257, 誤差: 0.000000, 有效: ✗
  分析相位 0.590820(權重:0.0012):
    分數近似: 13/22, 誤差: 0.000089, 有效: ✗
  分析相位 0.659912(權重:0.0012):
    分數近似: 33/50, 誤差: 0.000088, 有效: ✗
    分數近似: 749/1135, 誤差: 0.000000, 有效: ✗
  分析相位 0.395752(權重:0.0012):
    分數近似: 19/48, 誤差: 0.000081, 有效: ✗
    分數近似: 503/1271, 誤差: 0.000001, 有效: ✓, 評分:0.0012
    添加r=1271到候選列表 (評分:0.0012)
  分析相位 0.089355(權重:0.0010):
    分數近似: 5/56, 誤差: 0.000070, 有效: ✓, 評分:0.0010
    添加r=56到候選列表 (評分:0.0010)
    分數近似: 115/1287, 誤差: 0.000000, 有效: ✗
  分析相位 0.098877(權重:0.0010):
    分數近似: 9/91, 誤差: 0.000024, 有效: ✓, 評分:0.0010
    添加r=91到候選列表 (評分:0.0010)
    分數近似: 44/445, 誤差: 0.000001, 有效: ✗
  分析相位 0.561279(權重:0.0010):
    分數近似: 55/98, 誤差: 0.000055, 有效: ✗
    分數近似: 316/563, 誤差: 0.000000, 有效: ✗
  分析相位 0.390625(權重:0.0010):
    分數近似: 25/64, 誤差: 0.000000, 有效: ✗
  分析相位 0.632568(權重:0.0010):
    分數近似: 31/49, 誤差: 0.000085, 有效: ✗
    分數近似: 303/479, 誤差: 0.000001, 有效: ✗
  分析相位 0.213135(權重:0.0010):
    分數近似: 13/61, 誤差: 0.000020, 有效: ✓, 評分:0.0010
    添加r=61到候選列表 (評分:0.0010)
    分數近似: 172/807, 誤差: 0.000000, 有效: ✗
  分析相位 0.609863(權重:0.0010):
    分數近似: 25/41, 誤差: 0.000107, 有效: ✓, 評分:0.0010
    添加r=41到候選列表 (評分:0.0010)
    分數近似: 841/1379, 誤差: 0.000001, 有效: ✗
  分析相位 0.160645(權重:0.0010):
    分數近似: 209/1301, 誤差: 0.000001, 有效: ✓, 評分:0.0010
    添加r=1301到候選列表 (評分:0.0010)
  分析相位 0.185059(權重:0.0010):
    分數近似: 5/27, 誤差: 0.000127, 有效: ✗
    分數近似: 109/589, 誤差: 0.000001, 有效: ✗
  分析相位 0.942871(權重:0.0010):
    分數近似: 33/35, 誤差: 0.000014, 有效: ✗
    分數近似: 1337/1418, 誤差: 0.000006, 有效: ✗
  分析相位 0.323486(權重:0.0010):
    分數近似: 11/34, 誤差: 0.000043, 有效: ✗
    分數近似: 219/677, 誤差: 0.000000, 有效: ✗
  分析相位 0.931885(權重:0.0010):
    分數近似: 41/44, 誤差: 0.000067, 有效: ✗
    分數近似: 643/690, 誤差: 0.000001, 有效: ✗
  分析相位 0.583984(權重:0.0010):
    分數近似: 299/512, 誤差: 0.000000, 有效: ✗
  分析相位 0.717773(權重:0.0010):
    分數近似: 61/85, 誤差: 0.000126, 有效: ✗
  分析相位 0.232178(權重:0.0010):
    分數近似: 241/1038, 誤差: 0.000000, 有效: ✗
  分析相位 0.547607(權重:0.0010):
    分數近似: 23/42, 誤差: 0.000012, 有效: ✗
    分數近似: 765/1397, 誤差: 0.000005, 有效: ✗
  分析相位 0.748779(權重:0.0010):
    分數近似: 3/4, 誤差: 0.001221, 有效: ✗
    分數近似: 307/410, 誤差: 0.000001, 有效: ✗

排序後的r值候選列表:
  優先級1: r = 4096, 評分 = 0.0013
  優先級2: r = 1261, 評分 = 0.0013
  優先級3: r = 861, 評分 = 0.0012
  優先級4: r = 1271, 評分 = 0.0012
  優先級5: r = 1301, 評分 = 0.0010
  優先級6: r = 61, 評分 = 0.0010
  優先級7: r = 91, 評分 = 0.0010
  優先級8: r = 56, 評分 = 0.0010
  優先級9: r = 41, 評分 = 0.0010

最終r值候選列表: [1, 6, 11, 16, 21, 4096, 1261, 861, 1271, 1301]...

--- 步驟 4: 使用r=1恢復明文 ---
  固定點條件檢查: C^(n*e*r) ≡ C (mod n): ✓
  方法1: M = C^(n*e*r-1) mod n = 14^(1000) mod 143 = 1, 驗證: ✗
  方法2: M = C^(phi(n)*e*r-1) mod n = 14^(839) mod 143 = 92, 驗證: ✗
  方法3: M = C^(λ(n)*e*r-1) mod n = 14^(419) mod 143 = 92, 驗證: ✗
  方法4: M = C^((r-1)/e) mod n = 14^(0) mod 143 = 1, 驗證: ✗
  方法5: M = C^(n*e*r+1) mod n = 14^(1002) mod 143 = 53, 驗證: ✗
  方法6: M = C^((n-r)*e) mod n = 14^(994) mod 143 = 92, 驗證: ✗
  方法7: M = C^(phi(n)*(r%phi(n))-1) mod n = 14^(119) mod 143 = 92, 驗證: ✗
  方法8: M = C^(n*e*r-λ(n)) mod n = 14^(941) mod 143 = 14, 驗證: ✗
  方法10: r=1是2的冪，使用特殊處理
  方法10: M = C^((r*e*n)/2-1) mod n = 14^(499) mod 143 = 92, 驗證: ✗
  方法11: C在模143下的順序為5
  方法12: M = C^((λ(n)*r)%n) mod n = 14^(60) mod 143 = 1, 驗證: ✗
  所有恢復方法都失敗，無法恢復明文

--- 步驟 4: 使用r=6恢復明文 ---
  固定點條件檢查: C^(n*e*r) ≡ C (mod n): ✓
  方法1: M = C^(n*e*r-1) mod n = 14^(6005) mod 143 = 1, 驗證: ✗
  方法2: M = C^(phi(n)*e*r-1) mod n = 14^(5039) mod 143 = 92, 驗證: ✗
  方法3: M = C^(λ(n)*e*r-1) mod n = 14^(2519) mod 143 = 92, 驗證: ✗
  方法5: M = C^(n*e*r+1) mod n = 14^(6007) mod 143 = 53, 驗證: ✗
  方法6: M = C^((n-r)*e) mod n = 14^(959) mod 143 = 92, 驗證: ✗
  方法7: M = C^(phi(n)*(r%phi(n))-1) mod n = 14^(719) mod 143 = 92, 驗證: ✗
  方法8: M = C^(n*e*r-λ(n)) mod n = 14^(5946) mod 143 = 14, 驗證: ✗
  方法11: C在模143下的順序為5
  方法12: M = C^((λ(n)*r)%n) mod n = 14^(74) mod 143 = 92, 驗證: ✗
  所有恢復方法都失敗，無法恢復明文

--- 步驟 4: 使用r=11恢復明文 ---
  固定點條件檢查: C^(n*e*r) ≡ C (mod n): ✓
  方法1: M = C^(n*e*r-1) mod n = 14^(11010) mod 143 = 1, 驗證: ✗
  方法2: M = C^(phi(n)*e*r-1) mod n = 14^(9239) mod 143 = 92, 驗證: ✗
  方法3: M = C^(λ(n)*e*r-1) mod n = 14^(4619) mod 143 = 92, 驗證: ✗
  方法5: M = C^(n*e*r+1) mod n = 14^(11012) mod 143 = 53, 驗證: ✗
  方法6: M = C^((n-r)*e) mod n = 14^(924) mod 143 = 92, 驗證: ✗
  方法7: M = C^(phi(n)*(r%phi(n))-1) mod n = 14^(1319) mod 143 = 92, 驗證: ✗
  方法8: M = C^(n*e*r-λ(n)) mod n = 14^(10951) mod 143 = 14, 驗證: ✗
  方法11: C在模143下的順序為5
  方法12: M = C^((λ(n)*r)%n) mod n = 14^(88) mod 143 = 27, 驗證: ✓
  成功使用量子觀測公式恢復明文M = 27 (評分:0.75)

==================== 攻擊結果 ====================
成功! 恢復明文 M = 27
使用r值: 11
使用方法: 量子觀測公式
與原始明文匹配: ✓
用時: 0.01 秒

==================== 測試案例 6: 中型RSA-2(p=11,q=19) ====================
加密: 75^11 mod 209 = 75

==================== RSA量子固定點攻擊 ====================
模數 n = 209
指數 e = 11
密文 C = 75
根據n的大小(8位)，分配資源: 精度=12位, 測量=5200次
  特殊情況: C^e ≡ C (mod n)，C=75是RSA固定點

==================== 攻擊結果 ====================
成功! 恢復明文 M = 75
方法: 固定點特例
用時: 0.00 秒

==================== 測試案例 7: 非互質小型RSA ====================
加密: 5^3 mod 55 = 15

==================== RSA量子固定點攻擊 ====================
模數 n = 55
指數 e = 3
密文 C = 15
根據n的大小(6位)，分配資源: 精度=10位, 測量=4400次

--- 步驟 1: 理論分析RSA參數 ---
  φ(n) = 40
  尋找滿足固定點條件的r值...
  計算B = C^(n*e) mod n = 45
  注意: a=45與n=55不互質，使用強化計算方法
  在模11下找到1的乘法階: 1
  找到B的(廣義)乘法階: 1
  搜索乘法階1的因數...
  通過乘法階未找到足夠的r值，使用直接搜索...
  進行更廣泛的r值搜索...
  未找到理論上可能的r值，可能是RSA參數不存在有效的固定點

--- 步驟 2: 執行量子相位估計 (精度=10, 測量=4400次) ---
  模冪基底 B = C^(n*e) mod n = 45
  使用增強版量子相位估計模擬 (精度=10位, 4400次測量)
  注意: a=45與n=55不互質，使用強化計算方法
  在模11下找到1的乘法階: 1
  找到乘法階 r = 1
  增強相位估計模擬出錯: sum(): incompatible function arguments. The following argument types are supported:
    1. (arg0: pyqpanda.pyQPanda.var) -> pyqpanda.pyQPanda.var

Invoked with: dict_values([])

--- 步驟 3: 分析量子相位估計結果 ---
主要相位測量結果:
  相位值: 0.591797, 概率: 0.0027
  相位值: 0.744141, 概率: 0.0025
  相位值: 0.877930, 概率: 0.0025
  相位值: 0.324219, 概率: 0.0023
  相位值: 0.719727, 概率: 0.0023
  相位值: 0.241211, 概率: 0.0023
  相位值: 0.331055, 概率: 0.0023
  相位值: 0.461914, 概率: 0.0023
  相位值: 0.552734, 概率: 0.0023
  相位值: 0.629883, 概率: 0.0023

尋找可能的r值:
  分析相位 0.591797(權重:0.0027):
    分數近似: 29/49, 誤差: 0.000040, 有效: ✗
    分數近似: 303/512, 誤差: 0.000000, 有效: ✗
  分析相位 0.744141(權重:0.0025):
    分數近似: 32/43, 誤差: 0.000045, 有效: ✗
  分析相位 0.877930(權重:0.0025):
    分數近似: 36/41, 誤差: 0.000119, 有效: ✗
    分數近似: 187/213, 誤差: 0.000005, 有效: ✗
    分數近似: 899/1024, 誤差: 0.000000, 有效: ✗
  分析相位 0.324219(權重:0.0023):
    分數近似: 12/37, 誤差: 0.000106, 有效: ✗
    分數近似: 83/256, 誤差: 0.000000, 有效: ✗
  分析相位 0.719727(權重:0.0023):
    分數近似: 59/82, 誤差: 0.000214, 有效: ✗
    分數近似: 208/289, 誤差: 0.000003, 有效: ✗
  分析相位 0.241211(權重:0.0023):
    分數近似: 7/29, 誤差: 0.000168, 有效: ✗
    分數近似: 48/199, 誤差: 0.000005, 有效: ✗
  分析相位 0.331055(權重:0.0023):
    分數近似: 33/100, 誤差: 0.001055, 有效: ✗
    分數近似: 97/293, 誤差: 0.000003, 有效: ✗
  分析相位 0.461914(權重:0.0023):
    分數近似: 6/13, 誤差: 0.000376, 有效: ✗
    分數近似: 188/407, 誤差: 0.000002, 有效: ✗
  分析相位 0.552734(權重:0.0023):
    分數近似: 21/38, 誤差: 0.000103, 有效: ✗
  分析相位 0.629883(權重:0.0023):
    分數近似: 274/435, 誤差: 0.000002, 有效: ✗
  分析相位 0.822266(權重:0.0020):
    分數近似: 37/45, 誤差: 0.000043, 有效: ✗
  分析相位 0.496094(權重:0.0020):
    分數近似: 49/99, 誤差: 0.001144, 有效: ✗
  分析相位 0.264648(權重:0.0020):
    分數近似: 9/34, 誤差: 0.000057, 有效: ✗
    分數近似: 140/529, 誤差: 0.000002, 有效: ✗
  分析相位 0.571289(權重:0.0020):
    分數近似: 4/7, 誤差: 0.000140, 有效: ✗
    分數近似: 313/548, 誤差: 0.000121, 有效: ✗
  分析相位 0.546875(權重:0.0020):
    分數近似: 35/64, 誤差: 0.000000, 有效: ✗
  分析相位 0.376953(權重:0.0020):
    分數近似: 23/61, 誤差: 0.000096, 有效: ✗
  分析相位 0.753906(權重:0.0020):
    分數近似: 49/65, 誤差: 0.000060, 有效: ✗
  分析相位 0.444336(權重:0.0020):
    分數近似: 4/9, 誤差: 0.000109, 有效: ✗
    分數近似: 243/547, 誤差: 0.000095, 有效: ✗
  分析相位 0.686523(權重:0.0020):
    分數近似: 46/67, 誤差: 0.000044, 有效: ✗
    分數近似: 219/319, 誤差: 0.000003, 有效: ✗
  分析相位 0.205078(權重:0.0020):
    分數近似: 8/39, 誤差: 0.000050, 有效: ✗
  分析相位 0.505859(權重:0.0020):
    分數近似: 43/85, 誤差: 0.000023, 有效: ✗
  分析相位 0.341797(權重:0.0020):
    分數近似: 27/79, 誤差: 0.000025, 有效: ✗
  分析相位 0.807617(權重:0.0020):
    分數近似: 21/26, 誤差: 0.000075, 有效: ✗
    分數近似: 424/525, 誤差: 0.000002, 有效: ✗
  分析相位 0.208008(權重:0.0020):
    分數近似: 16/77, 誤差: 0.000216, 有效: ✗
    分數近似: 109/524, 誤差: 0.000007, 有效: ✗
  分析相位 0.795898(權重:0.0020):
    分數近似: 425/534, 誤差: 0.000018, 有效: ✗
  分析相位 0.044922(權重:0.0020):
    分數近似: 4/89, 誤差: 0.000022, 有效: ✗
  分析相位 0.292969(權重:0.0018):
  分析相位 0.885742(權重:0.0018):
    分數近似: 31/35, 誤差: 0.000028, 有效: ✗
  分析相位 0.332031(權重:0.0018):
    分數近似: 1/3, 誤差: 0.001302, 有效: ✗
  分析相位 0.234375(權重:0.0018):

未從相位推導出r值，使用直接搜索...
  未找到任何有效的r值，使用默認值r = 1

排序後的r值候選列表:
  優先級1: r = 1, 評分 = 0.5000

最終r值候選列表: [1]

--- 步驟 4: 使用r=1恢復明文 ---
  固定點條件檢查: C^(n*e*r) ≡ C (mod n): ✗
  r值不滿足固定點條件，無法使用此方法恢復明文

==================== 攻擊結果 ====================
攻擊失敗，無法恢復明文
用時: 0.01 秒

==================== 測試案例 8: 非互質中型RSA(p=13,q=19) ====================
加密: 19^3 mod 247 = 190

==================== RSA量子固定點攻擊 ====================
模數 n = 247
指數 e = 3
密文 C = 190
根據n的大小(8位)，分配資源: 精度=12位, 測量=5200次

--- 步驟 1: 理論分析RSA參數 ---
  φ(n) = 216
  尋找滿足固定點條件的r值...
  計算B = C^(n*e) mod n = 190
  注意: a=190與n=247不互質，使用強化計算方法
  在模13下找到8的乘法階: 4
  找到B的(廣義)乘法階: 4
  搜索乘法階4的因數...
  添加乘法階因數r = 1
  通過乘法階未找到足夠的r值，使用直接搜索...
  從搜索添加r = 5
  從搜索添加r = 9
  從搜索添加r = 13
  從搜索添加r = 17
  從搜索添加r = 21
  從搜索添加r = 25
  從搜索添加r = 29
  從搜索添加r = 33
  從搜索添加r = 37
  從搜索添加r = 41
  從搜索添加r = 45
  從搜索添加r = 49
  從搜索添加r = 57
  從搜索添加r = 69
  從搜索添加r = 81
  理論分析找到的r值: [1, 5, 9, 13, 17, 21, 25, 29, 33, 37]...

--- 步驟 2: 執行量子相位估計 (精度=12, 測量=5200次) ---
  模冪基底 B = C^(n*e) mod n = 190
  使用增強版量子相位估計模擬 (精度=12位, 5200次測量)
  注意: a=190與n=247不互質，使用強化計算方法
  在模13下找到8的乘法階: 4
  找到乘法階 r = 4
  增強相位估計模擬出錯: sum(): incompatible function arguments. The following argument types are supported:
    1. (arg0: pyqpanda.pyQPanda.var) -> pyqpanda.pyQPanda.var

Invoked with: dict_values([0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.007361673099632113, 0.002141540410481113, 0.009772969112889695, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.009492802198723086, 0.002412008765121949, 0.006357268825948524])

--- 步驟 3: 分析量子相位估計結果 ---
主要相位測量結果:
  相位值: 0.135010, 概率: 0.0015
  相位值: 0.398193, 概率: 0.0013
  相位值: 0.778564, 概率: 0.0012
  相位值: 0.065430, 概率: 0.0012
  相位值: 0.083740, 概率: 0.0012
  相位值: 0.326904, 概率: 0.0012
  相位值: 0.280518, 概率: 0.0012
  相位值: 0.320557, 概率: 0.0012
  相位值: 0.613037, 概率: 0.0012
  相位值: 0.057617, 概率: 0.0012

尋找可能的r值:
  分析相位 0.135010(權重:0.0015):
    分數近似: 5/37, 誤差: 0.000125, 有效: ✓, 評分:0.0015
    添加r=37到候選列表 (評分:0.0015)
    分數近似: 204/1511, 誤差: 0.000000, 有效: ✗
    分數近似: 553/4096, 誤差: 0.000000, 有效: ✗
  分析相位 0.398193(權重:0.0013):
    分數近似: 39/98, 誤差: 0.000234, 有效: ✗
    分數近似: 573/1439, 誤差: 0.000000, 有效: ✗
  分析相位 0.778564(權重:0.0012):
    分數近似: 74/95, 誤差: 0.000383, 有效: ✗
    分數近似: 1649/2118, 誤差: 0.000000, 有效: ✗
  分析相位 0.065430(權重:0.0012):
    分數近似: 4/61, 誤差: 0.000144, 有效: ✓, 評分:0.0011
    添加r=61到候選列表 (評分:0.0011)
    分數近似: 67/1024, 誤差: 0.000000, 有效: ✗
  分析相位 0.083740(權重:0.0012):
    分數近似: 1/12, 誤差: 0.000407, 有效: ✗
    分數近似: 120/1433, 誤差: 0.000000, 有效: ✓, 評分:0.0012
    添加r=1433到候選列表 (評分:0.0012)
  分析相位 0.326904(權重:0.0012):
    分數近似: 17/52, 誤差: 0.000019, 有效: ✗
    分數近似: 339/1037, 誤差: 0.000000, 有效: ✓, 評分:0.0012
    添加r=1037到候選列表 (評分:0.0012)
  分析相位 0.280518(權重:0.0012):
    分數近似: 23/82, 誤差: 0.000030, 有效: ✗
    分數近似: 347/1237, 誤差: 0.000000, 有效: ✓, 評分:0.0012
    添加r=1237到候選列表 (評分:0.0012)
  分析相位 0.320557(權重:0.0012):
    分數近似: 25/78, 誤差: 0.000044, 有效: ✗
    分數近似: 761/2374, 誤差: 0.000001, 有效: ✗
  分析相位 0.613037(權重:0.0012):
    分數近似: 19/31, 誤差: 0.000134, 有效: ✗
    分數近似: 442/721, 誤差: 0.000000, 有效: ✓, 評分:0.0012
    添加r=721到候選列表 (評分:0.0012)
  分析相位 0.057617(權重:0.0012):
  分析相位 0.873779(權重:0.0010):
    分數近似: 1163/1331, 誤差: 0.000000, 有效: ✗
  分析相位 0.478760(權重:0.0010):
    分數近似: 45/94, 誤差: 0.000036, 有效: ✗
    分數近似: 1127/2354, 誤差: 0.000000, 有效: ✗
  分析相位 0.422363(權重:0.0010):
    分數近似: 19/45, 誤差: 0.000141, 有效: ✓, 評分:0.0009
    添加r=45到候選列表 (評分:0.0009)
    分數近似: 865/2048, 誤差: 0.000000, 有效: ✗
  分析相位 0.193115(權重:0.0010):
    分數近似: 17/88, 誤差: 0.000067, 有效: ✗
    分數近似: 230/1191, 誤差: 0.000000, 有效: ✗
  分析相位 0.403076(權重:0.0010):
    分數近似: 27/67, 誤差: 0.000091, 有效: ✗
    分數近似: 865/2146, 誤差: 0.000001, 有效: ✗
  分析相位 0.848633(權重:0.0010):
    分數近似: 28/33, 誤差: 0.000148, 有效: ✓, 評分:0.0009
    添加r=33到候選列表 (評分:0.0009)
  分析相位 0.470459(權重:0.0010):
    分數近似: 8/17, 誤差: 0.000129, 有效: ✓, 評分:0.0009
    添加r=17到候選列表 (評分:0.0009)
    分數近似: 1067/2268, 誤差: 0.000000, 有效: ✗
  分析相位 0.185791(權重:0.0010):
    分數近似: 13/70, 誤差: 0.000077, 有效: ✗
    分數近似: 455/2449, 誤差: 0.000001, 有效: ✓, 評分:0.0010
    添加r=2449到候選列表 (評分:0.0010)
  分析相位 0.429443(權重:0.0010):
    分數近似: 43/100, 誤差: 0.000557, 有效: ✗
    分數近似: 563/1311, 誤差: 0.000000, 有效: ✗
  分析相位 0.105957(權重:0.0010):
    分數近似: 9/85, 誤差: 0.000075, 有效: ✓, 評分:0.0010
    添加r=85到候選列表 (評分:0.0010)
  分析相位 0.767334(權重:0.0010):
    分數近似: 33/43, 誤差: 0.000108, 有效: ✗
    分數近似: 1649/2149, 誤差: 0.000000, 有效: ✓, 評分:0.0010
    添加r=2149到候選列表 (評分:0.0010)
  分析相位 0.072021(權重:0.0010):
    分數近似: 7/97, 誤差: 0.000143, 有效: ✓, 評分:0.0009
    添加r=97到候選列表 (評分:0.0009)
    分數近似: 165/2291, 誤差: 0.000001, 有效: ✗
  分析相位 0.485840(權重:0.0010):
    分數近似: 17/35, 誤差: 0.000126, 有效: ✗
  分析相位 0.204834(權重:0.0010):
    分數近似: 17/83, 誤差: 0.000015, 有效: ✗
    分數近似: 500/2441, 誤差: 0.000000, 有效: ✓, 評分:0.0010
    添加r=2441到候選列表 (評分:0.0010)
  分析相位 0.718262(權重:0.0010):
    分數近似: 51/71, 誤差: 0.000048, 有效: ✗
  分析相位 0.090088(權重:0.0010):
    分數近似: 219/2431, 誤差: 0.000002, 有效: ✗
  分析相位 0.213867(權重:0.0010):
    分數近似: 19/89, 誤差: 0.000384, 有效: ✓, 評分:0.0009
    添加r=89到候選列表 (評分:0.0009)
  分析相位 0.250732(權重:0.0010):
    分數近似: 1/4, 誤差: 0.000732, 有效: ✗
    分數近似: 599/2389, 誤差: 0.000000, 有效: ✓, 評分:0.0010
    添加r=2389到候選列表 (評分:0.0010)
  分析相位 0.069824(權重:0.0010):
  分析相位 0.668457(權重:0.0010):

排序後的r值候選列表:
  優先級1: r = 37, 評分 = 0.0015
  優先級2: r = 1433, 評分 = 0.0012
  優先級3: r = 1237, 評分 = 0.0012
  優先級4: r = 1037, 評分 = 0.0012
  優先級5: r = 721, 評分 = 0.0012
  優先級6: r = 61, 評分 = 0.0011
  優先級7: r = 2441, 評分 = 0.0010
  優先級8: r = 2389, 評分 = 0.0010
  優先級9: r = 2149, 評分 = 0.0010
  優先級10: r = 2449, 評分 = 0.0010
  優先級11: r = 85, 評分 = 0.0010
  優先級12: r = 17, 評分 = 0.0009
  優先級13: r = 45, 評分 = 0.0009
  優先級14: r = 97, 評分 = 0.0009
  優先級15: r = 33, 評分 = 0.0009
  優先級16: r = 89, 評分 = 0.0009

最終r值候選列表: [1, 5, 9, 13, 37, 1433, 1237, 1037, 721, 61]...

--- 步驟 4: 使用r=1恢復明文 ---
  固定點條件檢查: C^(n*e*r) ≡ C (mod n): ✓
  方法1: M = C^(n*e*r-1) mod n = 190^(740) mod 247 = 209, 驗證: ✗
  方法2: M = C^(phi(n)*e*r-1) mod n = 190^(647) mod 247 = 57, 驗證: ✓
  方法3: M = C^(λ(n)*e*r-1) mod n = 190^(107) mod 247 = 57, 驗證: ✓
  方法4: M = C^((r-1)/e) mod n = 190^(0) mod 247 = 1, 驗證: ✗
  方法5: M = C^(n*e*r+1) mod n = 190^(742) mod 247 = 38, 驗證: ✗
  方法6: M = C^((n-r)*e) mod n = 190^(738) mod 247 = 38, 驗證: ✗
  方法7: M = C^(phi(n)*(r%phi(n))-1) mod n = 190^(215) mod 247 = 57, 驗證: ✓
  方法8: M = C^(n*e*r-λ(n)) mod n = 190^(705) mod 247 = 190, 驗證: ✗
  方法9: 注意到gcd(C,n)=19，使用模運算推導
  方法10: r=1是2的冪，使用特殊處理
  方法10: M = C^((r*e*n)/2-1) mod n = 190^(369) mod 247 = 190, 驗證: ✗
  注意: a=190與n=247不互質，使用強化計算方法
  在模13下找到8的乘法階: 4
  方法11: C在模247下的順序為4
  方法11: M = C^((order-1)/e) mod n = 190^(1) mod 247 = 190, 驗證: ✗
  方法12: M = C^((λ(n)*r)%n) mod n = 190^(36) mod 247 = 209, 驗證: ✗
  成功使用歐拉定理恢復明文M = 57 (評分:1.00)

==================== 攻擊結果 ====================
成功! 恢復明文 M = 57
使用r值: 1
使用方法: 歐拉定理
與原始明文匹配: ✗
用時: 0.01 秒

==================== 測試案例 9: 較大中型RSA(p=13,q=23) ====================
加密: 123^5 mod 299 = 223

==================== RSA量子固定點攻擊 ====================
模數 n = 299
指數 e = 5
密文 C = 223
根據n的大小(9位)，分配資源: 精度=13位, 測量=5600次

--- 步驟 1: 理論分析RSA參數 ---
  φ(n) = 264
  尋找滿足固定點條件的r值...
  計算B = C^(n*e) mod n = 128
  找到B的(廣義)乘法階: 132
  搜索乘法階132的因數...
  通過乘法階未找到足夠的r值，使用直接搜索...
  從搜索添加r = 43
  從搜索添加r = 175
  從搜索添加r = 1495
  進行更廣泛的r值搜索...
  從廣泛搜索添加r = 307
  從廣泛搜索添加r = 439
  從廣泛搜索添加r = 571
  從廣泛搜索添加r = 703
  從廣泛搜索添加r = 835
  從廣泛搜索添加r = 967
  從廣泛搜索添加r = 1099
  從廣泛搜索添加r = 1231
  從廣泛搜索添加r = 1363
  理論分析找到的r值: [43, 175, 307, 439, 571, 703, 835, 967, 1099, 1231]...

--- 步驟 2: 執行量子相位估計 (精度=13, 測量=5600次) ---
  模冪基底 B = C^(n*e) mod n = 128
  使用增強版量子相位估計模擬 (精度=13位, 5600次測量)
  找到乘法階 r = 132
  增強相位估計模擬出錯: sum(): incompatible function arguments. The following argument types are supported:
    1. (arg0: pyqpanda.pyQPanda.var) -> pyqpanda.pyQPanda.var

Invoked with: dict_values([0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.006250120390888421, 0.007644788095464105, 0.006339227042053041, 0.6, 0.01757477344936297, 0.054134113294645084, 0.13105981197347144, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.008253110692837063, 0.006138067744924651, 0.0009265872375661588, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.0077931849237632645, 0.00950187886068119, 0.01331126138238819, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.002663989716430286, 0.007860949721082762, 0.00036438971760344055, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.0005815815038002314, 0.004269790337748847, 0.002053725458446917, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.004035385123781353, 0.007782843988732138, 0.006727855948787609, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.006854015573452819, 0.002848346895284668, 0.009609854311590369, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.0010193273175672546, 0.003821340533847717, 0.0018968198592348717, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.0018623626285013417, 6.62227666962445e-05, 0.0018883905881884688, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.0065074678169015025, 0.0018925469253486583, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.0041896521327162576, 4.924928310989784e-07, 0.007843570196190284, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1368823084646656, 0.054134113294645084, 0.01757477344936297, 0.007661398039333982, 0.006188047739785458, 0.004547124707424208, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.0006654477559660555, 0.003880409058366261, 0.0024494146804634664, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.004696434087514772, 0.005137192148960586, 0.0010205494559988194, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.3608629788225646, 0.008124500780436538, 0.009393041012676292, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.35844523945787193, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.007454939149469371, 0.009129473066807175, 0.003626052715712922, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.006411484978527568, 0.006711661862476248, 0.005494560801351963, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.004193481118121285, 0.0027664535822268413, 0.004742764185735249, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.002896988153564767, 0.009141318733327783, 0.00839777387447804, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.004143272460283459, 0.005425205273570463, 0.002921410781632179, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.007401765535606053, 0.0025411053370222193, 0.0018458108868101542, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.003413779518179473, 0.004838031134772392, 0.0023572346130202515, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.003740805887363644, 0.004273822868288657, 0.009691860430219558, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.00029576978469875284, 0.001692643512026263, 0.0062290782350874945, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.0038248705520852635, 0.009647141651184485, 0.0054708825296599685, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.006678823312625482, 0.0033865457592910765, 0.004281947678710655, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.008104300018419261, 0.00035046637539210115, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.008127239496306542, 0.009308143035595552, 0.00024831149808268174, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.00963748210975492, 0.0004944037538396363, 0.008343609898150582, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 2.5811559771620198e-05, 0.004259536104399366, 0.0032013209546219745, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.005508376281883638, 0.0035072774147606157, 0.0062914024470537705, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.008880345197061988, 0.0089406994407414, 0.006618722443854263, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.009771453343952349, 0.005820918543520527, 9.003298804618254e-05, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.004983454978557134, 0.0009521724245203, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.0004817443643588926, 0.006115868400319378, 0.004866990782503898, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.006557805571593975, 0.0043309521590643016, 0.009203342609760266, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.0018533949764052394, 0.003998136760112854, 0.00019821766083213065, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.0033052391579303044, 0.006515351015676331, 0.005303168442997432, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.0007367406401751143, 0.0008475860192983198, 0.008576963278830145, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.006245331846004188, 0.0003802774556586386])

--- 步驟 3: 分析量子相位估計結果 ---
主要相位測量結果:
  相位值: 0.973389, 概率: 0.0011
  相位值: 0.838989, 概率: 0.0011
  相位值: 0.668823, 概率: 0.0009
  相位值: 0.678589, 概率: 0.0009
  相位值: 0.564087, 概率: 0.0009
  相位值: 0.963379, 概率: 0.0009
  相位值: 0.924316, 概率: 0.0009
  相位值: 0.409180, 概率: 0.0009
  相位值: 0.442749, 概率: 0.0009
  相位值: 0.815674, 概率: 0.0007

尋找可能的r值:
  分析相位 0.973389(權重:0.0011):
    分數近似: 73/75, 誤差: 0.000055, 有效: ✗
    分數近似: 2341/2405, 誤差: 0.000000, 有效: ✗
    分數近似: 3987/4096, 誤差: 0.000000, 有效: ✗
  分析相位 0.838989(權重:0.0011):
    分數近似: 73/87, 誤差: 0.000091, 有效: ✗
    分數近似: 1162/1385, 誤差: 0.000000, 有效: ✗
    分數近似: 6873/8192, 誤差: 0.000000, 有效: ✗
  分析相位 0.668823(權重:0.0009):
    分數近似: 67/100, 誤差: 0.001177, 有效: ✗
    分數近似: 1654/2473, 誤差: 0.000000, 有效: ✗
  分析相位 0.678589(權重:0.0009):
    分數近似: 19/28, 誤差: 0.000017, 有效: ✗
    分數近似: 1385/2041, 誤差: 0.000000, 有效: ✗
  分析相位 0.564087(權重:0.0009):
    分數近似: 22/39, 誤差: 0.000016, 有效: ✗
    分數近似: 933/1654, 誤差: 0.000000, 有效: ✗
  分析相位 0.963379(權重:0.0009):
    分數近似: 79/82, 誤差: 0.000036, 有效: ✗
    分數近似: 1973/2048, 誤差: 0.000000, 有效: ✗
  分析相位 0.924316(權重:0.0009):
    分數近似: 61/66, 誤差: 0.000074, 有效: ✗
  分析相位 0.409180(權重:0.0009):
    分數近似: 9/22, 誤差: 0.000089, 有效: ✗
    分數近似: 419/1024, 誤差: 0.000000, 有效: ✗
  分析相位 0.442749(權重:0.0009):
    分數近似: 31/70, 誤差: 0.000108, 有效: ✗
    分數近似: 58/131, 誤差: 0.000001, 有效: ✗
  分析相位 0.815674(權重:0.0007):
    分數近似: 31/38, 誤差: 0.000116, 有效: ✗
    分數近似: 2040/2501, 誤差: 0.000000, 有效: ✗
  分析相位 0.746704(權重:0.0007):
    分數近似: 1869/2503, 誤差: 0.000000, 有效: ✗
  分析相位 0.480713(權重:0.0007):
    分數近似: 25/52, 誤差: 0.000056, 有效: ✗
    分數近似: 1321/2748, 誤差: 0.000000, 有效: ✗
  分析相位 0.435181(權重:0.0007):
    分數近似: 37/85, 誤差: 0.000113, 有效: ✗
    分數近似: 903/2075, 誤差: 0.000000, 有效: ✗
  分析相位 0.259399(權重:0.0007):
    分數近似: 7/27, 誤差: 0.000140, 有效: ✗
    分數近似: 752/2899, 誤差: 0.000000, 有效: ✗
  分析相位 0.476196(權重:0.0007):
    分數近似: 10/21, 誤差: 0.000006, 有效: ✗
  分析相位 0.879639(權重:0.0007):
    分數近似: 73/83, 誤差: 0.000121, 有效: ✗
    分數近似: 1849/2102, 誤差: 0.000000, 有效: ✗
  分析相位 0.628906(權重:0.0007):
    分數近似: 61/97, 誤差: 0.000040, 有效: ✗
    分數近似: 161/256, 誤差: 0.000000, 有效: ✗
  分析相位 0.214966(權重:0.0007):
    分數近似: 20/93, 誤差: 0.000088, 有效: ✗
    分數近似: 158/735, 誤差: 0.000000, 有效: ✗
  分析相位 0.848267(權重:0.0007):
    分數近似: 67/79, 誤差: 0.000165, 有效: ✗
    分數近似: 1884/2221, 誤差: 0.000000, 有效: ✗
  分析相位 0.934570(權重:0.0007):
    分數近似: 57/61, 誤差: 0.000144, 有效: ✗
  分析相位 0.966064(權重:0.0007):
    分數近似: 57/59, 誤差: 0.000037, 有效: ✗
    分數近似: 2192/2269, 誤差: 0.000000, 有效: ✗
  分析相位 0.533813(權重:0.0007):
    分數近似: 47/88, 誤差: 0.000277, 有效: ✗
    分數近似: 1334/2499, 誤差: 0.000000, 有效: ✗
  分析相位 0.365234(權重:0.0007):
    分數近似: 187/512, 誤差: 0.000000, 有效: ✗
  分析相位 0.180054(權重:0.0007):
    分數近似: 9/50, 誤差: 0.000054, 有效: ✗
    分數近似: 269/1494, 誤差: 0.000000, 有效: ✗
  分析相位 0.493774(權重:0.0007):
    分數近似: 40/81, 誤差: 0.000053, 有效: ✗
    分數近似: 1388/2811, 誤差: 0.000000, 有效: ✗
  分析相位 0.038940(權重:0.0007):
    分數近似: 3/77, 誤差: 0.000021, 有效: ✗
    分數近似: 97/2491, 誤差: 0.000000, 有效: ✗
  分析相位 0.455566(權重:0.0007):
    分數近似: 41/90, 誤差: 0.000011, 有效: ✗
  分析相位 0.902222(權重:0.0007):
    分數近似: 83/92, 誤差: 0.000048, 有效: ✗
    分數近似: 203/225, 誤差: 0.000001, 有效: ✗
  分析相位 0.830322(權重:0.0007):
    分數近似: 44/53, 誤差: 0.000134, 有效: ✗
    分數近似: 2344/2823, 誤差: 0.000000, 有效: ✗
  分析相位 0.819946(權重:0.0007):

未從相位推導出r值，使用直接搜索...
  找到有效的r = 43
  找到有效的r = 175
  找到有效的r = 307
  找到有效的r = 439
  找到有效的r = 571
  找到有效的r = 703

排序後的r值候選列表:
  優先級1: r = 43, 評分 = 1.0000
  優先級2: r = 175, 評分 = 1.0000
  優先級3: r = 307, 評分 = 1.0000
  優先級4: r = 439, 評分 = 1.0000
  優先級5: r = 571, 評分 = 1.0000
  優先級6: r = 703, 評分 = 1.0000

最終r值候選列表: [43, 175, 307, 439, 571, 703]

--- 步驟 4: 使用r=43恢復明文 ---
  固定點條件檢查: C^(n*e*r) ≡ C (mod n): ✓
  方法1: M = C^(n*e*r-1) mod n = 223^(64284) mod 299 = 1, 驗證: ✗
  方法2: M = C^(phi(n)*e*r-1) mod n = 223^(56759) mod 299 = 59, 驗證: ✗
  方法3: M = C^(λ(n)*e*r-1) mod n = 223^(28379) mod 299 = 59, 驗證: ✗
  方法5: M = C^(n*e*r+1) mod n = 223^(64286) mod 299 = 95, 驗證: ✗
  方法6: M = C^((n-r)*e) mod n = 223^(1280) mod 299 = 9, 驗證: ✗
  方法7: M = C^(phi(n)*(r%phi(n))-1) mod n = 223^(11351) mod 299 = 59, 驗證: ✗
  方法8: M = C^(n*e*r-λ(n)) mod n = 223^(64153) mod 299 = 223, 驗證: ✗
  方法11: C在模299下的順序為132
  方法12: M = C^((λ(n)*r)%n) mod n = 223^(294) mod 299 = 12, 驗證: ✗
  所有恢復方法都失敗，無法恢復明文

--- 步驟 4: 使用r=175恢復明文 ---
  固定點條件檢查: C^(n*e*r) ≡ C (mod n): ✓
  方法1: M = C^(n*e*r-1) mod n = 223^(261624) mod 299 = 1, 驗證: ✗
  方法2: M = C^(phi(n)*e*r-1) mod n = 223^(230999) mod 299 = 59, 驗證: ✗
  方法3: M = C^(λ(n)*e*r-1) mod n = 223^(115499) mod 299 = 59, 驗證: ✗
  方法5: M = C^(n*e*r+1) mod n = 223^(261626) mod 299 = 95, 驗證: ✗
  方法6: M = C^((n-r)*e) mod n = 223^(620) mod 299 = 9, 驗證: ✗
  方法7: M = C^(phi(n)*(r%phi(n))-1) mod n = 223^(46199) mod 299 = 59, 驗證: ✗
  方法8: M = C^(n*e*r-λ(n)) mod n = 223^(261493) mod 299 = 223, 驗證: ✗
  方法11: C在模299下的順序為132
  方法12: M = C^((λ(n)*r)%n) mod n = 223^(77) mod 299 = 162, 驗證: ✗
  所有恢復方法都失敗，無法恢復明文

--- 步驟 4: 使用r=307恢復明文 ---
  固定點條件檢查: C^(n*e*r) ≡ C (mod n): ✓
  方法1: M = C^(n*e*r-1) mod n = 223^(458964) mod 299 = 1, 驗證: ✗
  方法2: M = C^(phi(n)*e*r-1) mod n = 223^(405239) mod 299 = 59, 驗證: ✗
  方法3: M = C^(λ(n)*e*r-1) mod n = 223^(202619) mod 299 = 59, 驗證: ✗
  方法5: M = C^(n*e*r+1) mod n = 223^(458966) mod 299 = 95, 驗證: ✗
  方法7: M = C^(phi(n)*(r%phi(n))-1) mod n = 223^(11351) mod 299 = 59, 驗證: ✗
  方法8: M = C^(n*e*r-λ(n)) mod n = 223^(458833) mod 299 = 223, 驗證: ✗
  方法11: C在模299下的順序為132
  方法12: M = C^((λ(n)*r)%n) mod n = 223^(159) mod 299 = 190, 驗證: ✗
  所有恢復方法都失敗，無法恢復明文

--- 步驟 4: 使用r=439恢復明文 ---
  固定點條件檢查: C^(n*e*r) ≡ C (mod n): ✓
  方法1: M = C^(n*e*r-1) mod n = 223^(656304) mod 299 = 1, 驗證: ✗
  方法2: M = C^(phi(n)*e*r-1) mod n = 223^(579479) mod 299 = 59, 驗證: ✗
  方法3: M = C^(λ(n)*e*r-1) mod n = 223^(289739) mod 299 = 59, 驗證: ✗
  方法5: M = C^(n*e*r+1) mod n = 223^(656306) mod 299 = 95, 驗證: ✗
  方法7: M = C^(phi(n)*(r%phi(n))-1) mod n = 223^(46199) mod 299 = 59, 驗證: ✗
  方法8: M = C^(n*e*r-λ(n)) mod n = 223^(656173) mod 299 = 223, 驗證: ✗
  方法11: C在模299下的順序為132
  方法12: M = C^((λ(n)*r)%n) mod n = 223^(241) mod 299 = 197, 驗證: ✗
  所有恢復方法都失敗，無法恢復明文

--- 步驟 4: 使用r=571恢復明文 ---
  固定點條件檢查: C^(n*e*r) ≡ C (mod n): ✓
  方法1: M = C^(n*e*r-1) mod n = 223^(853644) mod 299 = 1, 驗證: ✗
  方法2: M = C^(phi(n)*e*r-1) mod n = 223^(753719) mod 299 = 59, 驗證: ✗
  方法3: M = C^(λ(n)*e*r-1) mod n = 223^(376859) mod 299 = 59, 驗證: ✗
  方法4: M = C^((r-1)/e) mod n = 223^(114) mod 299 = 285, 驗證: ✗
  方法5: M = C^(n*e*r+1) mod n = 223^(853646) mod 299 = 95, 驗證: ✗
  方法7: M = C^(phi(n)*(r%phi(n))-1) mod n = 223^(11351) mod 299 = 59, 驗證: ✗
  方法8: M = C^(n*e*r-λ(n)) mod n = 223^(853513) mod 299 = 223, 驗證: ✗
  方法11: C在模299下的順序為132
  方法12: M = C^((λ(n)*r)%n) mod n = 223^(24) mod 299 = 118, 驗證: ✗
  所有恢復方法都失敗，無法恢復明文

--- 步驟 4: 使用r=703恢復明文 ---
  固定點條件檢查: C^(n*e*r) ≡ C (mod n): ✓
  方法1: M = C^(n*e*r-1) mod n = 223^(1050984) mod 299 = 1, 驗證: ✗
  方法2: M = C^(phi(n)*e*r-1) mod n = 223^(927959) mod 299 = 59, 驗證: ✗
  方法3: M = C^(λ(n)*e*r-1) mod n = 223^(463979) mod 299 = 59, 驗證: ✗
  方法5: M = C^(n*e*r+1) mod n = 223^(1050986) mod 299 = 95, 驗證: ✗
  方法7: M = C^(phi(n)*(r%phi(n))-1) mod n = 223^(46199) mod 299 = 59, 驗證: ✗
  方法8: M = C^(n*e*r-λ(n)) mod n = 223^(1050853) mod 299 = 223, 驗證: ✗
  方法11: C在模299下的順序為132
  方法12: M = C^((λ(n)*r)%n) mod n = 223^(106) mod 299 = 179, 驗證: ✗
  所有恢復方法都失敗，無法恢復明文

==================== 攻擊結果 ====================
攻擊失敗，無法恢復明文
用時: 0.02 秒

==================== 測試案例 10: 最大測試案例(p=17,q=23) ====================
加密: 200^3 mod 391 = 140

==================== RSA量子固定點攻擊 ====================
模數 n = 391
指數 e = 3
密文 C = 140
根據n的大小(9位)，分配資源: 精度=13位, 測量=5600次

--- 步驟 1: 理論分析RSA參數 ---
  φ(n) = 352
  尋找滿足固定點條件的r值...
  計算B = C^(n*e) mod n = 174
  找到B的(廣義)乘法階: 44
  搜索乘法階44的因數...
  通過乘法階未找到足夠的r值，使用直接搜索...
  從搜索添加r = 41
  從搜索添加r = 129
  從搜索添加r = 261
  進行更廣泛的r值搜索...
  從廣泛搜索添加r = 85
  從廣泛搜索添加r = 173
  從廣泛搜索添加r = 217
  從廣泛搜索添加r = 305
  從廣泛搜索添加r = 349
  從廣泛搜索添加r = 393
  從廣泛搜索添加r = 437
  從廣泛搜索添加r = 481
  從廣泛搜索添加r = 525
  從廣泛搜索添加r = 569
  從廣泛搜索添加r = 613
  從廣泛搜索添加r = 657
  從廣泛搜索添加r = 701
  從廣泛搜索添加r = 745
  從廣泛搜索添加r = 789
  從廣泛搜索添加r = 833
  從廣泛搜索添加r = 877
  理論分析找到的r值: [41, 85, 129, 173, 217, 261, 305, 349, 393, 437]...

--- 步驟 2: 執行量子相位估計 (精度=13, 測量=5600次) ---
  模冪基底 B = C^(n*e) mod n = 174
  使用增強版量子相位估計模擬 (精度=13位, 5600次測量)
  找到乘法階 r = 44
  增強相位估計模擬出錯: sum(): incompatible function arguments. The following argument types are supported:
    1. (arg0: pyqpanda.pyQPanda.var) -> pyqpanda.pyQPanda.var

Invoked with: dict_values([0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.003892956493895616, 0.0024551384630583407, 0.003814282349962652, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.0021283805663528466, 0.008211386207551945, 0.004948066531706736, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.006023786467298949, 0.0006402716634785199, 0.0054856124583259926, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.001324405016013338, 0.00013762348501375254, 0.005251877932078589, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.008457742472864092, 0.004357684737073818, 0.007990641785320173, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.003847947362393538, 0.002683169302076328, 0.002155165855125738, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.007071003321294728, 0.006139260737710678, 0.008071346187220111, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.005161575859134764, 0.0003837055458117911, 0.0011976907304748997, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.0040413298519735245, 0.002086920991076917, 0.0010971820415088963, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.0025636653019314084, 0.0006186938967834066, 0.0003482234843187404, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.009083172397748845, 0.0023219874231124407, 0.008655298491963434, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.0034543774825116424, 0.006963504131851948, 0.00023765905264774845, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.007117627126632041, 0.0037044789273913315, 0.003591332919123157, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.0005816214596830538, 0.009476802336340169, 0.001382116061005162, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.0037864508675184805, 0.0006299988148853286, 0.008596689442400121, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.0006701348158000775, 0.0002886261501781451, 0.009832282916242191, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.005244026193021318, 0.00947108075224792, 0.007455496882991851, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.0011645739313596792, 0.005261375377688715, 0.007569535404073035, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.00044708824339295016, 0.009960202380299425, 0.0028927724422143307, 0.6, 0.01757477344936297, 0.054134113294645084, 0.1298609869433399, 0.2426122638850534, 0.3529987610338382, 0.3529987610338382, 0.2426122638850534, 0.1298609869433399, 0.054134113294645084, 0.01757477344936297, 0.0031808865998698512, 0.005125141355719793, 0.004159118905851594])

--- 步驟 3: 分析量子相位估計結果 ---
主要相位測量結果:
  相位值: 0.277344, 概率: 0.0011
  相位值: 0.415527, 概率: 0.0009
  相位值: 0.220703, 概率: 0.0009
  相位值: 0.463379, 概率: 0.0009
  相位值: 0.439087, 概率: 0.0009
  相位值: 0.456055, 概率: 0.0009
  相位值: 0.840942, 概率: 0.0007
  相位值: 0.151611, 概率: 0.0007
  相位值: 0.343750, 概率: 0.0007
  相位值: 0.678345, 概率: 0.0007

尋找可能的r值:
  分析相位 0.277344(權重:0.0011):
    分數近似: 23/83, 誤差: 0.000235, 有效: ✗
    分數近似: 71/256, 誤差: 0.000000, 有效: ✗
  分析相位 0.415527(權重:0.0009):
    分數近似: 32/77, 誤差: 0.000057, 有效: ✗
    分數近似: 851/2048, 誤差: 0.000000, 有效: ✗
  分析相位 0.220703(權重:0.0009):
    分數近似: 113/512, 誤差: 0.000000, 有效: ✗
  分析相位 0.463379(權重:0.0009):
    分數近似: 19/41, 誤差: 0.000036, 有效: ✓, 評分:0.0009
    添加r=41到候選列表 (評分:0.0009)
  分析相位 0.439087(權重:0.0009):
    分數近似: 1712/3899, 誤差: 0.000000, 有效: ✗
    分數近似: 3597/8192, 誤差: 0.000000, 有效: ✗
  分析相位 0.456055(權重:0.0009):
    分數近似: 26/57, 誤差: 0.000086, 有效: ✗
    分數近似: 467/1024, 誤差: 0.000000, 有效: ✗
  分析相位 0.840942(權重:0.0007):
    分數近似: 37/44, 誤差: 0.000033, 有效: ✗
    分數近似: 571/679, 誤差: 0.000000, 有效: ✗
  分析相位 0.151611(權重:0.0007):
    分數近似: 5/33, 誤差: 0.000096, 有效: ✗
    分數近似: 334/2203, 誤差: 0.000000, 有效: ✗
    分數近似: 621/4096, 誤差: 0.000000, 有效: ✗
  分析相位 0.343750(權重:0.0007):
    分數近似: 11/32, 誤差: 0.000000, 有效: ✗
  分析相位 0.678345(權重:0.0007):
    分數近似: 59/87, 誤差: 0.000184, 有效: ✗
    分數近似: 2459/3625, 誤差: 0.000000, 有效: ✗
  分析相位 0.523315(權重:0.0007):
    分數近似: 45/86, 誤差: 0.000060, 有效: ✗
    分數近似: 101/193, 誤差: 0.000001, 有效: ✗
  分析相位 0.989990(權重:0.0007):
    分數近似: 99/100, 誤差: 0.000010, 有效: ✗
    分數近似: 3066/3097, 誤差: 0.000000, 有效: ✗
  分析相位 0.833130(權重:0.0007):
    分數近似: 5/6, 誤差: 0.000203, 有效: ✗
    分數近似: 2047/2457, 誤差: 0.000000, 有效: ✗
  分析相位 0.688477(權重:0.0007):
    分數近似: 42/61, 誤差: 0.000048, 有效: ✗
  分析相位 0.555542(權重:0.0007):
    分數近似: 5/9, 誤差: 0.000014, 有效: ✗
  分析相位 0.511963(權重:0.0007):
    分數近似: 43/84, 誤差: 0.000058, 有效: ✗
    分數近似: 1990/3887, 誤差: 0.000000, 有效: ✗
  分析相位 0.283691(權重:0.0007):
    分數近似: 21/74, 誤差: 0.000092, 有效: ✗
  分析相位 0.530029(權重:0.0007):
    分數近似: 1262/2381, 誤差: 0.000000, 有效: ✗
  分析相位 0.472778(權重:0.0007):
    分數近似: 26/55, 誤差: 0.000051, 有效: ✗
    分數近似: 1346/2847, 誤差: 0.000000, 有效: ✗
  分析相位 0.196777(權重:0.0007):
  分析相位 0.092773(權重:0.0007):
    分數近似: 9/97, 誤差: 0.000010, 有效: ✗
  分析相位 0.906860(權重:0.0007):
    分數近似: 39/43, 誤差: 0.000116, 有效: ✗
    分數近似: 1811/1997, 誤差: 0.000000, 有效: ✗
  分析相位 0.270386(權重:0.0007):
    分數近似: 10/37, 誤差: 0.000115, 有效: ✗
    分數近似: 63/233, 誤差: 0.000001, 有效: ✗
  分析相位 0.046265(權重:0.0007):
    分數近似: 3/65, 誤差: 0.000111, 有效: ✗
    分數近似: 122/2637, 誤差: 0.000000, 有效: ✓, 評分:0.0007
    添加r=2637到候選列表 (評分:0.0007)
  分析相位 0.074951(權重:0.0007):
    分數近似: 3/40, 誤差: 0.000049, 有效: ✗
    分數近似: 269/3589, 誤差: 0.000000, 有效: ✗
  分析相位 0.137329(權重:0.0007):
    分數近似: 7/51, 誤差: 0.000074, 有效: ✗
    分數近似: 472/3437, 誤差: 0.000000, 有效: ✗
  分析相位 0.492310(權重:0.0007):
  分析相位 0.877197(權重:0.0007):
    分數近似: 3393/3868, 誤差: 0.000000, 有效: ✗
  分析相位 0.530762(權重:0.0007):
    分數近似: 43/81, 誤差: 0.000102, 有效: ✗
  分析相位 0.932983(權重:0.0007):
    分數近似: 14/15, 誤差: 0.000350, 有效: ✗
    分數近似: 2311/2477, 誤差: 0.000000, 有效: ✗

排序後的r值候選列表:
  優先級1: r = 41, 評分 = 0.0009
  優先級2: r = 2637, 評分 = 0.0007

最終r值候選列表: [85, 129, 173, 217, 41, 2637]

--- 步驟 4: 使用r=85恢復明文 ---
  固定點條件檢查: C^(n*e*r) ≡ C (mod n): ✓
  方法1: M = C^(n*e*r-1) mod n = 140^(99704) mod 391 = 1, 驗證: ✗
  方法2: M = C^(phi(n)*e*r-1) mod n = 140^(89759) mod 391 = 81, 驗證: ✗
  方法3: M = C^(λ(n)*e*r-1) mod n = 140^(44879) mod 391 = 81, 驗證: ✗
  方法4: M = C^((r-1)/e) mod n = 140^(28) mod 391 = 18, 驗證: ✗
  方法5: M = C^(n*e*r+1) mod n = 140^(99706) mod 391 = 50, 驗證: ✗
  方法6: M = C^((n-r)*e) mod n = 140^(918) mod 391 = 101, 驗證: ✗
  方法7: M = C^(phi(n)*(r%phi(n))-1) mod n = 140^(29919) mod 391 = 81, 驗證: ✗
  方法8: M = C^(n*e*r-λ(n)) mod n = 140^(99529) mod 391 = 140, 驗證: ✗
  方法11: C在模391下的順序為44
  方法12: M = C^((λ(n)*r)%n) mod n = 140^(102) mod 391 = 169, 驗證: ✗
  所有恢復方法都失敗，無法恢復明文

--- 步驟 4: 使用r=129恢復明文 ---
  固定點條件檢查: C^(n*e*r) ≡ C (mod n): ✓
  方法1: M = C^(n*e*r-1) mod n = 140^(151316) mod 391 = 1, 驗證: ✗
  方法2: M = C^(phi(n)*e*r-1) mod n = 140^(136223) mod 391 = 81, 驗證: ✗
  方法3: M = C^(λ(n)*e*r-1) mod n = 140^(68111) mod 391 = 81, 驗證: ✗
  方法5: M = C^(n*e*r+1) mod n = 140^(151318) mod 391 = 50, 驗證: ✗
  方法6: M = C^((n-r)*e) mod n = 140^(786) mod 391 = 101, 驗證: ✗
  方法7: M = C^(phi(n)*(r%phi(n))-1) mod n = 140^(45407) mod 391 = 81, 驗證: ✗
  方法8: M = C^(n*e*r-λ(n)) mod n = 140^(151141) mod 391 = 140, 驗證: ✗
  方法11: C在模391下的順序為44
  方法12: M = C^((λ(n)*r)%n) mod n = 140^(26) mod 391 = 16, 驗證: ✗
  所有恢復方法都失敗，無法恢復明文

--- 步驟 4: 使用r=173恢復明文 ---
  固定點條件檢查: C^(n*e*r) ≡ C (mod n): ✓
  方法1: M = C^(n*e*r-1) mod n = 140^(202928) mod 391 = 1, 驗證: ✗
  方法2: M = C^(phi(n)*e*r-1) mod n = 140^(182687) mod 391 = 81, 驗證: ✗
  方法3: M = C^(λ(n)*e*r-1) mod n = 140^(91343) mod 391 = 81, 驗證: ✗
  方法5: M = C^(n*e*r+1) mod n = 140^(202930) mod 391 = 50, 驗證: ✗
  方法6: M = C^((n-r)*e) mod n = 140^(654) mod 391 = 101, 驗證: ✗
  方法7: M = C^(phi(n)*(r%phi(n))-1) mod n = 140^(60895) mod 391 = 81, 驗證: ✗
  方法8: M = C^(n*e*r-λ(n)) mod n = 140^(202753) mod 391 = 140, 驗證: ✗
  方法11: C在模391下的順序為44
  方法12: M = C^((λ(n)*r)%n) mod n = 140^(341) mod 391 = 208, 驗證: ✗
  所有恢復方法都失敗，無法恢復明文

--- 步驟 4: 使用r=217恢復明文 ---
  固定點條件檢查: C^(n*e*r) ≡ C (mod n): ✓
  方法1: M = C^(n*e*r-1) mod n = 140^(254540) mod 391 = 1, 驗證: ✗
  方法2: M = C^(phi(n)*e*r-1) mod n = 140^(229151) mod 391 = 81, 驗證: ✗
  方法3: M = C^(λ(n)*e*r-1) mod n = 140^(114575) mod 391 = 81, 驗證: ✗
  方法4: M = C^((r-1)/e) mod n = 140^(72) mod 391 = 18, 驗證: ✗
  方法5: M = C^(n*e*r+1) mod n = 140^(254542) mod 391 = 50, 驗證: ✗
  方法6: M = C^((n-r)*e) mod n = 140^(522) mod 391 = 101, 驗證: ✗
  方法7: M = C^(phi(n)*(r%phi(n))-1) mod n = 140^(76383) mod 391 = 81, 驗證: ✗
  方法8: M = C^(n*e*r-λ(n)) mod n = 140^(254365) mod 391 = 140, 驗證: ✗
  方法11: C在模391下的順序為44
  方法12: M = C^((λ(n)*r)%n) mod n = 140^(265) mod 391 = 140, 驗證: ✗
  所有恢復方法都失敗，無法恢復明文

--- 步驟 4: 使用r=41恢復明文 ---
  固定點條件檢查: C^(n*e*r) ≡ C (mod n): ✓
  方法1: M = C^(n*e*r-1) mod n = 140^(48092) mod 391 = 1, 驗證: ✗
  方法2: M = C^(phi(n)*e*r-1) mod n = 140^(43295) mod 391 = 81, 驗證: ✗
  方法3: M = C^(λ(n)*e*r-1) mod n = 140^(21647) mod 391 = 81, 驗證: ✗
  方法5: M = C^(n*e*r+1) mod n = 140^(48094) mod 391 = 50, 驗證: ✗
  方法6: M = C^((n-r)*e) mod n = 140^(1050) mod 391 = 101, 驗證: ✗
  方法7: M = C^(phi(n)*(r%phi(n))-1) mod n = 140^(14431) mod 391 = 81, 驗證: ✗
  方法8: M = C^(n*e*r-λ(n)) mod n = 140^(47917) mod 391 = 140, 驗證: ✗
  方法11: C在模391下的順序為44
  方法12: M = C^((λ(n)*r)%n) mod n = 140^(178) mod 391 = 50, 驗證: ✗
  所有恢復方法都失敗，無法恢復明文

--- 步驟 4: 使用r=2637恢復明文 ---
  固定點條件檢查: C^(n*e*r) ≡ C (mod n): ✓
  方法1: M = C^(n*e*r-1) mod n = 140^(3093200) mod 391 = 1, 驗證: ✗
  方法2: M = C^(phi(n)*e*r-1) mod n = 140^(2784671) mod 391 = 81, 驗證: ✗
  方法3: M = C^(λ(n)*e*r-1) mod n = 140^(1392335) mod 391 = 81, 驗證: ✗
  方法5: M = C^(n*e*r+1) mod n = 140^(3093202) mod 391 = 50, 驗證: ✗
  方法7: M = C^(phi(n)*(r%phi(n))-1) mod n = 140^(60895) mod 391 = 81, 驗證: ✗
  方法8: M = C^(n*e*r-λ(n)) mod n = 140^(3093025) mod 391 = 140, 驗證: ✗
  方法11: C在模391下的順序為44
  方法12: M = C^((λ(n)*r)%n) mod n = 140^(386) mod 391 = 186, 驗證: ✗
  所有恢復方法都失敗，無法恢復明文

==================== 攻擊結果 ====================
攻擊失敗，無法恢復明文
用時: 0.01 秒

==================== 測試結果摘要 ====================
| 案例 | 描述 | n | e | 原文 | 密文 | 成功? | 恢復明文 | 方法 | 用時(秒) |
|------|------|---|---|------|------|-------|----------|------|----------|
| 1 | 微型RSA(p=3,q=5) | 15 | 3 | 4 | 4 | ✓ | 4 | 固定點特例 | 0.00 |
| 2 | 小型RSA(p=5,q=7) | 35 | 5 | 6 | 6 | ✓ | 6 | 固定點特例 | 0.00 |
| 3 | 較小RSA(p=7,q=11) | 77 | 7 | 42 | 70 | ✓ | 42 | 模運算推導 | 0.01 |
| 4 | 標準小型RSA(p=7,q=13) | 91 | 3 | 9 | 1 | ✓ | 1 | 固定點特例 | 0.00 |
| 5 | 中型RSA(p=11,q=13) | 143 | 7 | 27 | 14 | ✓ | 27 | 量子觀測公式 | 0.01 |
| 6 | 中型RSA-2(p=11,q=19) | 209 | 11 | 75 | 75 | ✓ | 75 | 固定點特例 | 0.00 |
| 7 | 非互質小型RSA | 55 | 3 | 5 | 15 | ✗ | N/A | N/A | 0.01 |
| 8 | 非互質中型RSA(p=13,q=19) | 247 | 3 | 19 | 190 | ✓ | 57 | 歐拉定理 | 0.01 |
| 9 | 較大中型RSA(p=13,q=23) | 299 | 5 | 123 | 223 | ✗ | N/A | N/A | 0.02 |
| 10 | 最大測試案例(p=17,q=23) | 391 | 3 | 200 | 140 | ✗ | N/A | N/A | 0.01 |

成功率: 7/10 = 70.0%
當前日期時間: 2025-04-14 21:38:43
當前用戶: RogerLiao0001
